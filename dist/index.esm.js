import e,{useState as t,useRef as a,useEffect as n}from"react";var r,o=function(){return o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,function(e){e.MONTH_YEAR="month-year",e.FULL_DATE="full-date",e.SHORT_DATE="short-date"}(r||(r={}));var l={headerBackground:"bg-white",headerText:"text-gray-700",backgroundHighlight:"bg-blue-50",borderColor:"border-gray-200",todayMarkerColor:"bg-red-500"};function i(e){return e.toLocaleString("default",{month:"short"})}function c(e,t){switch(void 0===t&&(t=r.FULL_DATE),t){case r.MONTH_YEAR:return e.toLocaleString("default",{month:"short",year:"2-digit"});case r.SHORT_DATE:return e.toLocaleString("default",{month:"short",day:"numeric"});case r.FULL_DATE:default:return e.toLocaleString("default",{month:"short",day:"numeric",year:"numeric"})}}function s(e,t){for(var a=[],n=e.getFullYear(),r=e.getMonth(),o=t.getFullYear(),l=t.getMonth(),i=n;i<=o;i++)for(var c=i===o?l:11,s=i===n?r:0;s<=c;s++)a.push(new Date(i,s,1));return a}function d(e,t){return new Date(e,t+1,0).getDate()}function u(){return[1,8,15,22,29]}function m(e,t,a){var n=s(new Date(t.getFullYear(),t.getMonth(),1),new Date(a.getFullYear(),a.getMonth()+1,0)),r=n.length,o=e.startDate.getFullYear(),l=e.startDate.getMonth(),i=n.findIndex((function(e){return e.getFullYear()===o&&e.getMonth()===l})),c=i<0?0:i,d=e.endDate.getFullYear(),u=e.endDate.getMonth(),m=n.findIndex((function(e){return e.getFullYear()===d&&e.getMonth()===u})),f=((m<0?n.length-1:m)-c+1)/r*100;return{left:"".concat(c/r*100,"%"),width:"".concat(f,"%")}}function f(e){var t=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a=[];return t.forEach((function(e){for(var t=!1,n=0;n<a.length;n++){if(!a[n].some((function(t){return!(e.startDate>=t.endDate||e.endDate<=t.startDate)}))){a[n].push(e),t=!0;break}}t||a.push([e])})),a}function h(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.startDate<t&&(t=new Date(e.startDate))}))})),new Date(t.getFullYear(),t.getMonth(),1)}function g(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.endDate>t&&(t=new Date(e.endDate))}))})),new Date(t.getFullYear(),t.getMonth()+1,0)}var v=function(r){var l,i,c=r.person,s=r.startDate,d=r.endDate,u=r.totalMonths,h=r.monthWidth,g=r.editMode,v=void 0===g||g,p=r.onTaskUpdate,b=r.onTaskClick,y=t(null),x=y[0],E=y[1],w=t(null),D=w[0],k=w[1],M=t(null),N=M[0],T=M[1],F=t(0),L=F[0],S=F[1],Y=t({x:0,y:0}),C=Y[0],z=Y[1],A=a(null),O=f(c.tasks),R=Math.max(60,40*O.length+20),U=function(){D||E(null)},_=function(e){if(A.current){var t=A.current.getBoundingClientRect();z({x:e.clientX-t.left+20,y:e.clientY-t.top})}},B=function(e){var t,a;if(e instanceof MouseEvent&&"mousemove"===e.type){if(x){var n=e;z({x:n.clientX-((null===(t=A.current)||void 0===t?void 0:t.getBoundingClientRect().left)||0)+20,y:n.clientY-((null===(a=A.current)||void 0===a?void 0:a.getBoundingClientRect().top)||0)})}}else _(e);if(D&&N&&A.current){A.current.getBoundingClientRect();var r=u*h,o=e.clientX-L,l=document.querySelector('[data-task-id="'.concat(D.id,'"]'));if(!l)return;var i=parseFloat(l.style.left),c=parseFloat(l.style.width);if("move"===N){var s=Math.max(0,Math.min(r-c,i+o));l.style.left="".concat(s,"px")}else if("resize-left"===N){var d=c-20,m=Math.min(d,o),f=(s=Math.max(0,i+m),Math.max(20,c-m));l.style.left="".concat(s,"px"),l.style.width="".concat(f,"px")}else if("resize-right"===N){f=Math.max(20,Math.min(r-i,c+o));l.style.width="".concat(f,"px")}S(e.clientX)}},H=function(e,t,a){v&&(e.preventDefault(),e.stopPropagation(),k(t),T(a),S(e.clientX),document.addEventListener("mouseup",P),document.addEventListener("mousemove",B))},P=function(){if(D&&N&&A.current){var e=document.querySelector('[data-task-id="'.concat(D.id,'"]'));if(e){var t=parseFloat(e.style.left),a=parseFloat(e.style.width),n=(d.getTime()-s.getTime())/(u*h),r=t*n,l=a*n,i=new Date(s.getTime()+r),m=new Date(i.getTime()+l),f=o(o({},D),{startDate:i,endDate:m});p&&p(c.id,f)}}k(null),T(null),document.removeEventListener("mouseup",P),document.removeEventListener("mousemove",B)};n((function(){return function(){document.removeEventListener("mouseup",P),document.removeEventListener("mousemove",B)}}),[]);var X=function(e){return e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},I=function(e,t){var a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)},j=function(e,t){var a=document.querySelector('[data-task-id="'.concat(e,'"]'));if(!a)return"start"===t?s:d;var n=parseFloat(a.style.left||"0"),r=parseFloat(a.style.width||"0"),o=(d.getTime()-s.getTime())/(u*h);if("start"===t){var l=n*o;return new Date(s.getTime()+l)}var i=(n+r)*o;return new Date(s.getTime()+i)};return c.tasks&&0!==c.tasks.length?e.createElement("div",{className:"relative",style:{height:"".concat(R,"px")},onMouseMove:function(e){return B(e)},onMouseLeave:function(){return E(null)},ref:A,"data-testid":"task-row-".concat(c.id)},O.map((function(t,a){return e.createElement(e.Fragment,{key:"task-row-".concat(a)},t.map((function(t){var n=m(t,s,d),r=n.left,o=n.width,l=parseFloat(r)*u*h/100,i=parseFloat(o)*u*h/100,f=(null==x?void 0:x.id)===t.id,g=(null==D?void 0:D.id)===t.id,p=(f||g)&&v;return e.createElement("div",{key:"task-".concat(t.id),className:"absolute h-8 rounded ".concat(t.color," flex items-center px-2 text-xs text-white font-medium ").concat(v?"cursor-move":"cursor-pointer"),style:{left:"".concat(l,"px"),width:"".concat(i,"px"),top:"".concat(40*a+10,"px")},onClick:function(e){return function(e,t){b&&!D&&b(t,c)}(0,t)},onMouseDown:function(e){return H(e,t,"move")},onMouseEnter:function(e){return function(e,t){D||(E(t),_(e))}(e,t)},onMouseLeave:U,"data-testid":"task-".concat(t.id),"data-task-id":t.id},p&&e.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 cursor-ew-resize rounded-l",onMouseDown:function(e){e.stopPropagation(),H(e,t,"resize-left")}}),e.createElement("div",{className:"truncate select-none"},t.name),void 0!==t.percent&&e.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 rounded-full overflow-hidden"},e.createElement("div",{className:"h-full bg-white rounded-full",style:{width:"".concat(t.percent,"%")}})),p&&e.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 cursor-ew-resize rounded-r",onMouseDown:function(e){e.stopPropagation(),H(e,t,"resize-right")}}))})))})),(x||D)&&e.createElement("div",{className:"absolute z-20 bg-white border border-gray-200 rounded-md shadow-md p-2 text-xs select-none",style:{left:"".concat(C.x,"px"),top:"".concat(C.y-40,"px"),minWidth:"150px"}},e.createElement("div",{className:"font-bold mb-1"},null===(l=D||x)||void 0===l?void 0:l.name),e.createElement("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1"},e.createElement("div",{className:"font-semibold"},"Start:"),e.createElement("div",null,X(N&&D?j(D.id,"start"):(D||x).startDate)),e.createElement("div",{className:"font-semibold"},"End:"),e.createElement("div",null,X(N&&D?j(D.id,"end"):(D||x).endDate)),e.createElement("div",{className:"font-semibold"},"Duration:"),e.createElement("div",null,N&&D?I(j(D.id,"start"),j(D.id,"end")):I((D||x).startDate,(D||x).endDate)," ","days"),void 0!==(null===(i=D||x)||void 0===i?void 0:i.percent)&&e.createElement(e.Fragment,null,e.createElement("div",{className:"font-semibold"},"Progress:"),e.createElement("div",null,(D||x).percent,"%"))))):e.createElement("div",{className:"relative h-16"},"No tasks available")},p=function(t){var n=t.people,r=t.startDate,o=t.endDate,i=t.title,c=void 0===i?"Project Timeline":i,d=t.currentDate,u=void 0===d?new Date:d,m=t.showCurrentDateMarker,p=void 0===m||m,b=t.editMode,y=void 0===b||b,x=t.theme,E=void 0===x?l:x,w=t.onTaskUpdate,D=t.onTaskClick,k=a(null),M=a(null),N=r||h(n),T=o||g(n),F=s(N,T),L=F.length,S=u.getMonth(),Y=u.getFullYear(),C=F.findIndex((function(e){return e.getMonth()===S&&e.getFullYear()===Y}));E.headerBackground,E.headerText,E.borderColor;var z,A=E.backgroundHighlight||"bg-blue-50",O=E.todayMarkerColor||"bg-red-500";return e.createElement("div",{ref:k,className:"w-full bg-white rounded-xl shadow-lg overflow-hidden","data-testid":"gantt-chart"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h1",{className:"text-2xl font-bold text-gray-800"},c)),e.createElement("div",{className:"relative flex"},e.createElement("div",{className:"w-40 flex-shrink-0 z-10 bg-white shadow-sm"},e.createElement("div",{className:"p-2 font-semibold text-gray-700 border-r border-b border-gray-200 h-12"},"Team Member"),n.map((function(t){var a=f(t.tasks),n=Math.max(60,30*a.length+15);return e.createElement("div",{key:"person-".concat(t.id),className:"p-2 border-r border-b border-gray-200 font-medium",style:{height:"".concat(n,"px")},"data-testid":"person-label-".concat(t.id)},e.createElement("div",{className:"font-medium"},t.name),t.role&&e.createElement("div",{className:"text-xs text-gray-500"},t.role))}))),e.createElement("div",{ref:M,className:"flex-grow overflow-x-auto"},e.createElement("div",{className:"min-w-max"},e.createElement("div",{className:"flex border-b border-gray-200"},F.map((function(t,a){return e.createElement("div",{key:a,className:"w-[150px] flex-shrink-0 p-2 font-semibold text-center ".concat(a===C?A:""),"data-month":t.toISOString()},t.toLocaleString("default",{month:"short",year:"2-digit"}))}))),e.createElement("div",{className:"relative"},p&&C>=0&&e.createElement("div",{className:"absolute top-0 w-px ".concat(O," z-10"),style:{left:"".concat(150*(C+.5),"px"),height:"".concat((z=0,n.forEach((function(e){var t=f(e.tasks);z+=Math.max(60,30*t.length+15)})),z),"px")},"data-testid":"today-marker"},e.createElement("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 ".concat(O," px-1 py-0.5 rounded text-xs text-white whitespace-nowrap")},"Today")),n.map((function(t){return e.createElement(v,{key:"task-row-".concat(t.id),person:t,startDate:N,endDate:T,totalMonths:L,monthWidth:150,editMode:y,onTaskUpdate:w,onTaskClick:D})})))))))};export{l as DEFAULT_THEME,r as DateDisplayFormat,p as GanttChart,v as TaskRow,m as calculateTaskPosition,f as detectTaskOverlaps,h as findEarliestDate,g as findLatestDate,c as formatDate,i as formatMonth,d as getDaysInMonth,s as getMonthsBetween,u as getStandardDayMarkers};
//# sourceMappingURL=index.esm.js.map
