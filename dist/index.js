"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a,n=t(e),r=function(){return r=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,exports.DateDisplayFormat=void 0,(a=exports.DateDisplayFormat||(exports.DateDisplayFormat={})).MONTH_YEAR="MONTH_YEAR",a.WEEK_DAY="WEEK_DAY",a.DAY_MONTH="DAY_MONTH",a.FULL_DATE="FULL_DATE";var o={headerBackground:"bg-gray-50",headerText:"text-gray-700",timelineBackground:"bg-gray-50",timelineBorder:"border-gray-200",timelineText:"text-gray-500",taskDefaultColor:"bg-blue-500",highlightColor:"bg-indigo-100",todayMarkerColor:"bg-red-500",tooltipBackground:"bg-white",tooltipText:"text-gray-700"};function l(e,t){switch(void 0===t&&(t=exports.DateDisplayFormat.MONTH_YEAR),t){case exports.DateDisplayFormat.MONTH_YEAR:return e.toLocaleString("default",{month:"short",year:"numeric"}).toUpperCase();case exports.DateDisplayFormat.WEEK_DAY:return e.toLocaleString("default",{weekday:"short",day:"numeric"});case exports.DateDisplayFormat.DAY_MONTH:return e.toLocaleString("default",{day:"numeric",month:"short"});case exports.DateDisplayFormat.FULL_DATE:return e.toLocaleDateString("default",{year:"numeric",month:"short",day:"numeric"});default:return e.toLocaleString("default",{month:"short",year:"numeric"})}}function s(e,t){return new Date(e,t+1,0).getDate()}function c(e,t){var a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)}function i(e,t,a,n){var r=c(t,a),o=Math.max(0,c(t,e.startDate)-1),l=Math.min(r,c(t,e.endDate))-o,i=n/s(t.getFullYear(),t.getMonth()),u=o*i,d=l*i,m=e.startDate>a||e.endDate<t;return{left:"".concat(u,"px"),width:"".concat(d,"px"),isOutOfRange:m}}function u(e){var t=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a=[];return t.forEach((function(e){for(var t=!1,n=0;n<a.length;n++){var r=a[n][a[n].length-1];if(e.startDate>=r.endDate){a[n].push(e),t=!0;break}}t||a.push([e])})),a}function d(e,t){for(var a=[],n=new Date(e);n<=t;)a.push(l(n,exports.DateDisplayFormat.MONTH_YEAR)),n.setMonth(n.getMonth()+1);return a}var m=function(e){var t=e.people,a=e.showAvatar,r=void 0===a||a,o=e.showTaskCount,l=void 0===o||o,s=e.theme,c=(null==s?void 0:s.headerBackground)||"bg-gray-50",i=(null==s?void 0:s.headerText)||"text-gray-700",d=(null==s?void 0:s.timelineBorder)||"border-gray-200";return n.default.createElement("div",{className:"name-list w-64 flex-shrink-0 bg-white border-r border-gray-200 z-10"},n.default.createElement("div",{className:"h-24 border-b ".concat(d," ").concat(c," flex items-center justify-center")},n.default.createElement("span",{className:"font-semibold ".concat(i)},"Team Members")),n.default.createElement("div",{className:"people-list"},t.map((function(e,a){var o=u(e.tasks),s=Math.max(60,40*o.length),c=e.name.charAt(0).toUpperCase();return n.default.createElement("div",{key:e.id,className:"flex items-center px-4 ".concat(a!==t.length-1?"border-b ".concat(d):""),style:{height:"".concat(s,"px")}},r&&(e.avatar?n.default.createElement("img",{src:e.avatar,alt:e.name,className:"w-8 h-8 rounded-full mr-3"}):n.default.createElement("div",{className:"w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-white text-sm mr-3"},c)),n.default.createElement("div",{className:"flex flex-col"},n.default.createElement("div",{className:"font-medium text-sm"},e.name),e.role&&n.default.createElement("div",{className:"text-xs text-gray-500"},e.role),l&&n.default.createElement("div",{className:"text-xs text-gray-500 mt-1"},e.tasks.length," ",1===e.tasks.length?"task":"tasks")))}))))},f=function(e){for(var t=e.startDate,a=e.endDate,r=e.columnWidth,o=e.theme,c=e.children,i=e.scrollContainerRef,u=[],d=new Date(t);d<=a;)u.push({date:new Date(d),daysInMonth:s(d.getFullYear(),d.getMonth())}),d.setMonth(d.getMonth()+1);var m=(null==o?void 0:o.headerBackground)||"bg-gray-50",f=(null==o?void 0:o.headerText)||"text-gray-700",p=(null==o?void 0:o.timelineBorder)||"border-gray-200",v=(null==o?void 0:o.timelineText)||"text-gray-500";return n.default.createElement("div",{className:"timeline flex-grow overflow-x-auto overflow-y-hidden",ref:i},n.default.createElement("div",{className:"inline-block min-w-full"},n.default.createElement("div",{className:"grid border-b",style:{gridTemplateColumns:"repeat(".concat(u.length,", ").concat(r,"px)")}},u.map((function(e,t){return n.default.createElement("div",{key:"month-".concat(t),className:"border-r ".concat(p)},n.default.createElement("div",{className:"flex h-12 items-center justify-center ".concat(m)},n.default.createElement("p",{className:"font-semibold ".concat(f)},l(e.date,exports.DateDisplayFormat.MONTH_YEAR))),n.default.createElement("div",{className:"flex h-12 items-center justify-between px-2 text-xs ".concat(v," ").concat(m)},(e.date.getFullYear(),e.date.getMonth(),a=e.daysInMonth,r=[1],a>=8&&r.push(8),a>=15&&r.push(15),a>=22&&r.push(22),a>=29&&r.push(29),r).map((function(t){return n.default.createElement("div",{key:"day-".concat(e.date.getMonth(),"-").concat(t),className:"relative",style:{width:"20px",textAlign:"center"}},n.default.createElement("span",null,t),n.default.createElement("div",{className:"absolute top-full h-screen w-px bg-gray-200 -z-10",style:{left:"50%",transform:"translateX(-50%)"}}))}))));var a,r}))),n.default.createElement("div",{className:"relative task-container"},c)))},p=function(t){var a=t.person,o=t.startDate,s=t.endDate,d=t.columnWidth,m=t.theme,f=t.onTaskUpdate,p=t.onTaskClick,v=e.useState(null),h=v[0],g=v[1],D=e.useState(null),x=D[0],E=D[1],y=e.useState(0),w=y[0],b=y[1],N=e.useState(null),T=N[0],k=N[1],M=e.useState({x:0,y:0}),L=M[0],A=M[1],C=e.useRef(null),F=function(e){return l(e,exports.DateDisplayFormat.FULL_DATE)},_=function(e,t,a){e.preventDefault(),g(t),E(a),b(e.clientX),R(e),document.addEventListener("mouseup",Y),document.addEventListener("mousemove",O)},O=function(e){if(h&&x&&C.current){var t=C.current.getBoundingClientRect(),n=(e.clientX-w)*(c(o,s)/t.width),l=new Date(h.startDate),i=new Date(h.endDate);if("move"===x?(l=new Date(l.getTime()+24*n*60*60*1e3),i=new Date(i.getTime()+24*n*60*60*1e3)):"resize-start"===x?l=new Date(l.getTime()+24*n*60*60*1e3):"resize-end"===x&&(i=new Date(i.getTime()+24*n*60*60*1e3)),l<o&&(l=new Date(o),"move"===x)){var u=c(h.startDate,h.endDate);i=new Date(l.getTime()+24*u*60*60*1e3)}if(i>s&&(i=new Date(s),"move"===x)){u=c(h.startDate,h.endDate);l=new Date(i.getTime()-24*u*60*60*1e3)}i<l&&("resize-start"===x?l=new Date(i):i=new Date(l));var d=r(r({},h),{startDate:l,endDate:i});f&&f(a.id,d),g(d),b(e.clientX)}},Y=function(){g(null),E(null),document.removeEventListener("mouseup",Y),document.removeEventListener("mousemove",O)},R=function(e){if(C.current){var t=C.current.getBoundingClientRect();A({x:e.clientX-t.left,y:e.clientY-t.top})}};e.useEffect((function(){return function(){document.removeEventListener("mouseup",Y),document.removeEventListener("mousemove",O)}}),[]);var S=u(a.tasks),z=40*S.length,B=(null==m?void 0:m.tooltipBackground)||"bg-white",H=(null==m?void 0:m.tooltipText)||"text-gray-700";return n.default.createElement("div",{className:"task-row relative border-b border-gray-200",style:{height:"".concat(Math.max(60,z),"px")},onMouseMove:function(e){T&&R(e)},onMouseLeave:function(){return k(null)},ref:C},S.map((function(e,t){return e.map((function(e){var r=function(e){return i(e,o,s,d)}(e),l=r.left,u=r.width;if(r.isOutOfRange)return null;var m=(null==T?void 0:T.id)===e.id||(null==h?void 0:h.id)===e.id;return n.default.createElement(n.default.Fragment,{key:e.id},n.default.createElement("div",{className:"absolute h-8 rounded-md ".concat(e.color||"bg-blue-500"," z-10 flex items-center px-2 text-xs text-white font-medium cursor-move shadow-sm hover:shadow transition-shadow duration-150"),style:{left:l,width:u,top:"".concat(40*t+4,"px")},onMouseDown:function(t){return _(t,e,"move")},onMouseEnter:function(){return k(e)},onClick:function(t){return function(e,t){e.stopPropagation(),p&&p(t,a)}(t,e)}},n.default.createElement("span",{className:"truncate select-none"},e.name),void 0!==e.percent&&n.default.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 rounded-full overflow-hidden"},n.default.createElement("div",{className:"h-full bg-white rounded-full",style:{width:"".concat(e.percent,"%")}})),m&&n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize",onMouseDown:function(t){t.stopPropagation(),_(t,e,"resize-start")}},n.default.createElement("div",{className:"absolute left-[3px] w-1 h-[16px] top-1/2 -translate-y-1/2 bg-white rounded-full"})),n.default.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize",onMouseDown:function(t){t.stopPropagation(),_(t,e,"resize-end")}},n.default.createElement("div",{className:"absolute right-[3px] w-1 h-[16px] top-1/2 -translate-y-1/2 bg-white rounded-full"})))),m&&n.default.createElement("div",{className:"absolute z-50 ".concat(B," border border-gray-200 rounded-md shadow-lg p-3 text-xs select-none"),style:{left:"".concat(L.x+10,"px"),top:"".concat(L.y-80,"px"),minWidth:"200px"}},n.default.createElement("div",{className:"font-bold mb-1 text-sm"},e.name),n.default.createElement("div",{className:"".concat(H," grid grid-cols-2 gap-x-3 gap-y-1")},n.default.createElement("div",{className:"font-semibold"},"Start:"),n.default.createElement("div",null,F(e.startDate)),n.default.createElement("div",{className:"font-semibold"},"End:"),n.default.createElement("div",null,F(e.endDate)),n.default.createElement("div",{className:"font-semibold"},"Duration:"),n.default.createElement("div",null,c(e.startDate,e.endDate)," days"),void 0!==e.percent&&n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"font-semibold"},"Progress:"),n.default.createElement("div",null,e.percent,"%")))))}))})))};exports.DEFAULT_THEME=o,exports.GanttChart=function(t){var a=t.people,r=t.startDate,l=t.endDate,s=t.title,i=void 0===s?"Project Timeline":s,u=t.showAvatar,v=void 0===u||u,h=t.showTaskCount,g=void 0===h||h,D=t.theme,x=void 0===D?o:D,E=t.onTaskUpdate,y=t.onTaskClick,w=t.currentDate,b=void 0===w?new Date:w,N=t.showCurrentDateMarker,T=void 0===N||N;t.visibleColumns;var k=t.columnWidth,M=void 0===k?200:k,L=r||function(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.startDate<t&&(t=new Date(e.startDate))}))})),t}(a),A=l||function(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.endDate>t&&(t=new Date(e.endDate))}))})),t}(a),C=new Date(L);C.setDate(1);var F=new Date(A);F.setMonth(F.getMonth()+1,0);var _=c(C,F);d(C,F);var O=e.useRef(null),Y=e.useState(0),R=Y[0],S=Y[1],z=function(e,t,a){var n=c(t,e);return n/a*100}(b,C,_);e.useEffect((function(){var e=function(){O.current&&S(O.current.scrollLeft)},t=O.current;return t&&t.addEventListener("scroll",e),function(){t&&t.removeEventListener("scroll",e)}}),[]);var B=function(e,t){E&&E(e,t)},H=function(e,t){y&&y(e,t)};return n.default.createElement("div",{className:"gantt-chart w-full rounded-lg border border-gray-200 overflow-hidden"},n.default.createElement("div",{className:"p-4 border-b border-gray-200"},n.default.createElement("h2",{className:"text-xl font-bold"},i)),n.default.createElement("div",{className:"flex"},n.default.createElement(m,{people:a,showAvatar:v,showTaskCount:g,theme:x}),n.default.createElement("div",{className:"flex-grow relative"},n.default.createElement(f,{startDate:C,endDate:F,columnWidth:M,theme:x,scrollContainerRef:O},a.map((function(e){return n.default.createElement(p,{key:e.id,person:e,startDate:C,endDate:F,columnWidth:M,theme:x,onTaskUpdate:B,onTaskClick:H})}))),T&&n.default.createElement("div",{className:"absolute top-0 bottom-0 w-px ".concat(x.todayMarkerColor||"bg-red-500"," z-20"),style:{left:"".concat(z,"%"),transform:"translateX(-".concat(R,"px)")}},n.default.createElement("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 ".concat(x.todayMarkerColor||"bg-red-500"," px-2 py-1 rounded text-xs text-white whitespace-nowrap")},"Today")))))},exports.NameList=m,exports.TaskRow=p,exports.Timeline=f,exports.calculateTaskPosition=i,exports.detectCollisions=u,exports.formatDate=l,exports.generateTimelineHeader=d,exports.getDaysInMonth=s,exports.getDuration=c;
//# sourceMappingURL=index.js.map
