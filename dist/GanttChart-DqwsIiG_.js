import e,{useRef as t,useState as r,useEffect as n,forwardRef as a,useCallback as o,useMemo as i,createContext as s,useContext as c}from"react";import{startOfDay as l,endOfDay as u,isWithinInterval as d,differenceInDays as g,differenceInYears as h,differenceInQuarters as m,differenceInMonths as f,differenceInWeeks as v,format as D,isValid as w,getWeek as M,startOfYear as k,addYears as p,startOfQuarter as b,addQuarters as x,addDays as E,addHours as y,addMinutes as T}from"date-fns";var N,A,H=function(){return H=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},H.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,function(e){e.MINUTE="minute",e.HOUR="hour",e.DAY="day",e.WEEK="week",e.MONTH="month",e.QUARTER="quarter",e.YEAR="year"}(N||(N={})),function(e){e.MONTH_YEAR="month-year",e.FULL_DATE="full-date",e.SHORT_DATE="short-date"}(A||(A={}));var R={colors:{background:"#ffffff",text:"#1f2937",border:"#e5e7eb",highlight:"#eff6ff",task:{background:"#3b82f6",text:"#ffffff",border:"#2563eb",progress:"rgba(0, 0, 0, 0.2)",progressFill:"#ffffff"},timeline:{background:"#ffffff",headerBackground:"#f9fafb",headerText:"#1f2937",marker:"#ef4444"},scrollbar:{track:"rgba(229, 231, 235, 0.5)",thumb:"rgba(156, 163, 175, 0.7)",thumbHover:"rgba(107, 114, 128, 0.8)"}},sizes:{rowHeight:40,taskHeight:32,unitWidth:{minute:30,hour:40,day:50,week:80,month:150,quarter:180,year:200},borderRadius:"4px",fontSize:"0.875rem"},animation:{speed:.25,easing:"cubic-bezier(0.2, 0, 0.13, 2)"}},C=H(H({},R),{colors:{background:"#1f2937",text:"#f3f4f6",border:"#374151",highlight:"#2d3748",task:{background:"#4f46e5",text:"#ffffff",border:"#6366f1",progress:"rgba(0, 0, 0, 0.3)",progressFill:"#e5e7eb"},timeline:{background:"#1f2937",headerBackground:"#111827",headerText:"#e5e7eb",marker:"#ef4444"},scrollbar:{track:"rgba(55, 65, 81, 0.5)",thumb:"rgba(75, 85, 99, 0.7)",thumbHover:"rgba(107, 114, 128, 0.8)"}}});function Y(e,t){return void 0===t&&(t=!0),"\n".concat(t?":root":""," {\n  /* Base colors */\n  --rmg-bg-color: ").concat(e.colors.background,";\n  --rmg-text-color: ").concat(e.colors.text,";\n  --rmg-border-color: ").concat(e.colors.border,";\n  --rmg-highlight-color: ").concat(e.colors.highlight,";\n\n  /* Task colors */\n  --rmg-task-bg-color: ").concat(e.colors.task.background,";\n  --rmg-task-text-color: ").concat(e.colors.task.text,";\n  --rmg-task-border-color: ").concat(e.colors.task.border,";\n  --rmg-task-progress-color: ").concat(e.colors.task.progress,";\n  --rmg-task-progress-fill-color: ").concat(e.colors.task.progressFill,";\n\n  /* Timeline colors */\n  --rmg-timeline-bg-color: ").concat(e.colors.timeline.background,";\n  --rmg-timeline-header-bg-color: ").concat(e.colors.timeline.headerBackground,";\n  --rmg-timeline-header-text-color: ").concat(e.colors.timeline.headerText,";\n  --rmg-timeline-marker-color: ").concat(e.colors.timeline.marker,";\n\n  /* Scrollbar colors */\n  --rmg-scrollbar-track-color: ").concat(e.colors.scrollbar.track,";\n  --rmg-scrollbar-thumb-color: ").concat(e.colors.scrollbar.thumb,";\n  --rmg-scrollbar-thumb-hover-color: ").concat(e.colors.scrollbar.thumbHover,";\n\n  /* Sizes */\n  --rmg-row-height: ").concat(e.sizes.rowHeight,"px;\n  --rmg-task-height: ").concat(e.sizes.taskHeight,"px;\n  --rmg-border-radius: ").concat(e.sizes.borderRadius,";\n  --rmg-font-size: ").concat(e.sizes.fontSize,";\n\n  /* Unit widths by view mode */\n  --rmg-unit-width-minute: ").concat(e.sizes.unitWidth.minute,"px;\n  --rmg-unit-width-hour: ").concat(e.sizes.unitWidth.hour,"px;\n  --rmg-unit-width-day: ").concat(e.sizes.unitWidth.day,"px;\n  --rmg-unit-width-week: ").concat(e.sizes.unitWidth.week,"px;\n  --rmg-unit-width-month: ").concat(e.sizes.unitWidth.month,"px;\n  --rmg-unit-width-quarter: ").concat(e.sizes.unitWidth.quarter,"px;\n  --rmg-unit-width-year: ").concat(e.sizes.unitWidth.year,"px;\n\n  /* Animation */\n  --rmg-animation-speed: ").concat(e.animation.speed,";\n  --rmg-animation-easing: ").concat(e.animation.easing,";\n}\n")}var U=Y(R),S=Y(C);function P(e,t){var r,n,a,o;void 0===t&&(t=!1);var i=t?C:R;return{colors:H(H(H({},i.colors),e.colors),{task:H(H({},i.colors.task),null===(r=e.colors)||void 0===r?void 0:r.task),timeline:H(H({},i.colors.timeline),null===(n=e.colors)||void 0===n?void 0:n.timeline),scrollbar:H(H({},i.colors.scrollbar),null===(a=e.colors)||void 0===a?void 0:a.scrollbar)}),sizes:H(H(H({},i.sizes),e.sizes),{unitWidth:H(H({},i.sizes.unitWidth),null===(o=e.sizes)||void 0===o?void 0:o.unitWidth)}),animation:H(H({},i.animation),e.animation)}}function F(e,t){return t}function L(e){return{container:"bg-[".concat(e.colors.background,"] text-[").concat(e.colors.text,"] border-[").concat(e.colors.border,"] rounded-[").concat(e.sizes.borderRadius,"]"),taskItem:"bg-[".concat(e.colors.task.background,"] text-[").concat(e.colors.task.text,"] rounded-[").concat(e.sizes.borderRadius,"]"),timeline:"bg-[".concat(e.colors.timeline.background,"]"),todayMarker:"bg-[".concat(e.colors.timeline.marker,"]"),scrollbar:"bg-[".concat(e.colors.scrollbar.track,"]"),scrollbarThumb:"bg-[".concat(e.colors.scrollbar.thumb,"]")}}var O=function(){function e(){}return e.detectOverlaps=function(e,t){var r=this;if(void 0===t&&(t=N.MONTH),!Array.isArray(e)||0===e.length)return[];var n=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate&&t.startDate?e.startDate.getTime()-t.startDate.getTime():0})),a=[];return n.forEach((function(e){for(var n=!1,o=0;o<a.length;o++){if(!a[o].some((function(n){return r.tasksVisuallyOverlap(e,n,t)}))){a[o].push(e),n=!0;break}}n||a.push([e])})),a},e.tasksVisuallyOverlap=function(e,t,r){if(void 0===r&&(r=N.MONTH),!(e.startDate&&e.endDate&&t.startDate&&t.endDate))return!1;var n=e.startDate.getTime(),a=e.endDate.getTime(),o=t.startDate.getTime(),i=t.endDate.getTime(),s=this.getCollisionBufferByViewMode(r);return n+s<i-s&&a-s>o+s||Math.abs(n-o)<2*s||Math.abs(a-i)<2*s},e.getCollisionBufferByViewMode=function(e){var t=36e5,r=24*t;switch(e){case N.MINUTE:return 3e4;case N.HOUR:return 9e5;case N.DAY:return t;case N.WEEK:return 4*t;case N.MONTH:return 12*t;case N.QUARTER:return r;case N.YEAR:return 2*r;default:return 12*t}},e.wouldCollide=function(e,t,r,n){var a=this;return void 0===r&&(r=N.MONTH),t.some((function(t){return t.id!==e.id&&t.id!==n&&a.tasksVisuallyOverlap(e,t,r)}))},e.getPreviewArrangement=function(e,t,r){void 0===r&&(r=N.MONTH);var n=t.map((function(t){return t.id===e.id?e:t}));return this.detectOverlaps(n,r)},e}(),W=function(){function e(){}return e.calculateDatesFromPosition=function(e,t,r,n,a,o,i){void 0===i&&(i=N.MONTH);try{var s=isNaN(e)?0:e,c=isNaN(t)||t<20?20:t,d=r.getTime(),g=(n.getTime()-d)/(a*o),h=s*g,m=c*g,f=new Date(d+h),v=new Date(d+h+m);switch(i){case N.MINUTE:f.setSeconds(0,0),v.setSeconds(59,999);break;case N.HOUR:f.setMinutes(0,0,0),v.setMinutes(59,59,999);break;case N.DAY:var D=Math.round(e/o),w=Math.max(1,Math.round(t/o)),M=new Date(r);M.setHours(0,0,0,0),(f=new Date(M)).setDate(M.getDate()+D),f.setHours(0,0,0,0),(v=new Date(f)).setDate(f.getDate()+w-1),v.setHours(23,59,59,999);break;default:f=l(f),v=u(v)}return f<r&&(f=new Date(r)),v>n&&(v=new Date(n)),{newStartDate:f,newEndDate:v}}catch(e){return console.error("Error calculating dates from position:",e),{newStartDate:new Date(r),newEndDate:new Date(n)}}},e.createUpdatedTask=function(e,t,r){return H(H({},e),{startDate:new Date(t),endDate:new Date(r)})},e.calculateTaskPixelPosition=function(e,t,r,n,a,o){var i;void 0===o&&(o=N.MONTH);try{if(!(e.startDate instanceof Date&&e.endDate instanceof Date))throw new Error("Invalid dates in task");var s=t.getTime(),c=r.getTime(),l=Math.max(e.startDate.getTime(),t.getTime()),u=Math.min(e.endDate.getTime(),r.getTime());if(o===N.MINUTE||o===N.HOUR||o===N.DAY){var d=void 0,g=void 0;if(o===N.MINUTE)d=s,g=c;else if(o===N.HOUR){var h=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),0,0,0).getTime(),m=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),59,59,999).getTime();d=h,g=m}else{var f=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),v=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).getTime();d=f,g=v}if(s=d,c=g,o===N.DAY){var D=new Date(new Date(l).getFullYear(),new Date(l).getMonth(),new Date(l).getDate(),0,0,0,0).getTime(),w=new Date(new Date(u).getFullYear(),new Date(u).getMonth(),new Date(u).getDate(),23,59,59,999).getTime();l=D,u=w}}var M=c-s,k=n*a,p=(l-s)/M*k,b=(u-l)/M*k;o===N.MINUTE?(p=Math.round(p),b=Math.max(10,Math.round(b))):o===N.HOUR?(p=Math.round(p),b=Math.max(15,Math.round(b))):o===N.DAY&&(p=Math.round(p/a)*a,b=Math.max(a,Math.round(b/a)*a));var x=((i={})[N.MINUTE]=10,i[N.HOUR]=15,i[N.DAY]=20,i[N.WEEK]=20,i[N.MONTH]=20,i[N.QUARTER]=30,i[N.YEAR]=40,i)[o]||20;b=Math.max(x,b);var E=k-p;return{leftPx:p,widthPx:b=Math.min(E,b)}}catch(e){return console.error("Error calculating task position:",e),{leftPx:0,widthPx:20}}},e.getLiveDatesFromElement=function(e,t,r,n,a,o){void 0===o&&(o=N.MONTH);try{if(!e)return{startDate:new Date(t),endDate:new Date(r)};var i=parseFloat(e.style.left||"0"),s=parseFloat(e.style.width||"0"),c=this.calculateDatesFromPosition(i,s,t,r,n,a,o);return{startDate:c.newStartDate,endDate:c.newEndDate}}catch(e){return console.error("Error getting live dates:",e),{startDate:new Date(t),endDate:new Date(r)}}},e.datesOverlap=function(e,t,r,n){return d(e,{start:r,end:n})||d(t,{start:r,end:n})||d(r,{start:e,end:t})||d(n,{start:e,end:t})},e}();function I(e,t){return void 0===t&&(t="default"),e.toLocaleString(t,{month:"short"})}function z(e,t,r){if(void 0===t&&(t=A.FULL_DATE),void 0===r&&(r="default"),!(e instanceof Date)||isNaN(e.getTime()))return"Invalid date";switch(t){case A.MONTH_YEAR:return e.toLocaleString(r,{month:"short",year:"2-digit"});case A.SHORT_DATE:return e.toLocaleString(r,{month:"short",day:"numeric"});case A.FULL_DATE:default:return e.toLocaleString(r,{month:"short",day:"numeric",year:"numeric"})}}function V(e,t){var r=[];if(!(e instanceof Date&&t instanceof Date))return[new Date];for(var n=e.getFullYear(),a=e.getMonth(),o=t.getFullYear(),i=t.getMonth(),s=n;s<=o;s++)for(var c=s===o?i:11,l=s===n?a:0;l<=c;l++)r.push(new Date(s,l,1));return r}function B(e,t){return new Date(e,t+1,0).getDate()}function q(e,t,r){void 0===r&&(r=N.MONTH);try{if(!(e instanceof Date)||!(t instanceof Date)||isNaN(e.getTime())||isNaN(t.getTime()))return{value:0,unit:"days"};var n=e<t?e:t,a=e<t?t:e;switch(r){case N.DAY:var o=g(a,n)+1;return{value:o,unit:1===o?"day":"days"};case N.WEEK:var i=v(a,n)+1;return{value:i,unit:1===i?"week":"weeks"};case N.MONTH:var s=f(a,n)+1;return{value:s,unit:1===s?"month":"months"};case N.QUARTER:var c=m(a,n)+1;return{value:c,unit:1===c?"quarter":"quarters"};case N.YEAR:var l=h(a,n)+1;return{value:l,unit:1===l?"year":"years"};default:var u=g(a,n)+1;return{value:u,unit:1===u?"day":"days"}}}catch(e){return console.error("Error calculating duration:",e),{value:0,unit:"days"}}}function K(e,t,r){if(void 0===r&&(r="default"),!(e instanceof Date&&t instanceof Date))return"Invalid date range";var n=z(e,A.SHORT_DATE,r),a=z(t,A.SHORT_DATE,r);return"".concat(n," - ").concat(a)}function G(e,t){var r;if(!(e instanceof Date&&t instanceof Date))return 0;e>t&&(e=(r=[t,e])[0],t=r[1]);var n=Math.abs(t.getTime()-e.getTime());return Math.ceil(n/864e5)}var Q=function(t){var r=t.task,n=t.position,a=t.dragType,o=t.taskId,i=t.startDate,s=t.endDate,c=t.totalMonths,l=t.monthWidth,u=t.showProgress,d=void 0!==u&&u,g=t.instanceId,h=t.className,m=void 0===h?"":h,f=t.viewMode,v=void 0===f?N.MONTH:f,w=t.renderTooltip,M=r.startDate,k=r.endDate;try{var p=o||r.id,b=document.querySelector('[data-task-id="'.concat(p,'"][data-instance-id="').concat(g,'"]'));if(b&&(a||b.style.left||b.style.width)){var x=W.getLiveDatesFromElement(b,i,s,c,l,v);M=x.startDate,k=x.endDate}}catch(e){console.error("Error calculating live dates for tooltip:",e)}var E=q(M,k,v),y=function(e){return e instanceof Date&&!isNaN(e.getTime())?v===N.DAY?D(e,"EEE, MMM d, yyyy"):D(e,"MMM d, yyyy"):"Invalid date"},T=function(){if(!a)return null;switch(a){case"move":return"Moving task...";case"resize-left":return"Adjusting start date...";case"resize-right":return"Adjusting end date...";default:return null}}();return w?e.createElement("div",{className:"rmg-task-tooltip absolute z-20 ".concat(m),style:{left:"".concat(n.x,"px"),top:"".concat(n.y-40,"px")}},w({task:r,position:n,dragType:a,startDate:M,endDate:k,viewMode:v})):e.createElement("div",{className:"rmg-task-tooltip absolute z-20 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-md shadow-md dark:shadow-gray-900 p-2 text-xs select-none ".concat(m),style:{left:"".concat(n.x,"px"),top:"".concat(n.y-40,"px"),minWidth:"200px"}},e.createElement("div",{className:"font-bold mb-1"},r.name||"Unnamed Task"),T&&e.createElement("div",{className:"text-xs text-blue-500 dark:text-blue-400 mb-1 italic"},T),e.createElement("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1"},e.createElement("div",{className:"font-semibold"},"Start:"),e.createElement("div",null,y(M)),e.createElement("div",{className:"font-semibold"},"End:"),e.createElement("div",null,y(k)),e.createElement("div",{className:"font-semibold"},"Duration:"),e.createElement("div",null,E.value," ",E.unit),d&&"number"==typeof r.percent&&e.createElement(e.Fragment,null,e.createElement("div",{className:"font-semibold"},"Progress:"),e.createElement("div",null,r.percent,"%")),r.dependencies&&r.dependencies.length>0&&e.createElement(e.Fragment,null,e.createElement("div",{className:"font-semibold"},"Dependencies:"),e.createElement("div",null,r.dependencies.join(", ")))))},_=function(a){var o=a.activeMode,i=a.onChange,s=a.darkMode,c=a.availableModes,l=[{id:N.MINUTE,label:"Minute"},{id:N.HOUR,label:"Hour"},{id:N.DAY,label:"Day"},{id:N.WEEK,label:"Week"},{id:N.MONTH,label:"Month"},{id:N.QUARTER,label:"Quarter"},{id:N.YEAR,label:"Year"}],u=[N.DAY,N.WEEK,N.MONTH,N.QUARTER,N.YEAR],d=c?l.filter((function(e){return c.includes(e.id)})):l.filter((function(e){return u.includes(e.id)})),g=t(null),h=r({left:"0px",width:"0px"}),m=h[0],f=h[1];n((function(){var e=function(){if(g.current){var e=g.current.querySelector('[aria-selected="true"]');if(e){var t=e,r=t.offsetLeft,n=t.offsetWidth;f({left:"".concat(r,"px"),width:"".concat(n,"px")})}}};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[o]);var v="\n    relative inline-flex rounded-full p-0.5\n    ".concat(s?"bg-gray-800/80":"bg-gray-100/90","\n    transition-all duration-300 ease-in-out shadow-sm dark:shadow-gray-900\n    border ").concat(s?"border-gray-700":"border-gray-200","\n    ");return e.createElement("div",{className:"relative flex items-center"},e.createElement("div",{ref:g,className:v,role:"tablist","aria-label":"View mode options"},e.createElement("span",{className:"\n                        absolute z-0 inset-0.5 rounded-full\n                        transition-all duration-300 ease-out transform\n                        ".concat(s?"bg-indigo-600":"bg-indigo-500","\n                    "),style:m,"aria-hidden":"true"}),d.map((function(t){return e.createElement("button",{key:t.id,role:"tab","aria-selected":o===t.id,"aria-controls":"panel-".concat(t.id),className:"".concat((r=o===t.id,"\n    relative z-10 px-3 py-1 text-xs font-medium\n    transition-all duration-200 ease-in-out\n    ".concat(r?"text-white":s?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700","\n    focus:outline-none border-none\n    "))," rounded-full"),onClick:function(){return i(t.id)}},t.label);var r}))))},X=function(t){var r=t.title,n=t.darkMode,a=t.activeViewMode,o=t.onViewModeChange,i=t.showViewModeSelector,s=t.availableViewModes,c=t.renderHeader,l=t.renderViewModeSelector,u=t.styles;return c?c({title:r,darkMode:n,viewMode:a,onViewModeChange:o,showViewModeSelector:i}):e.createElement("div",{className:"p-6 border-b border-gantt-border bg-gantt-bg ".concat(u.header||"")},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("h1",{className:"text-2xl font-bold text-gantt-text ".concat(u.title||"")},r),i&&e.createElement("div",{className:"flex space-x-2"},l?l({activeMode:a,onChange:o,darkMode:n,availableModes:s}):e.createElement(_,{activeMode:a,onChange:o,darkMode:n,availableModes:s}))))},j=function(t){var r=t.months,n=t.currentMonthIndex,a=(t.locale,t.className),o=void 0===a?"":a,i=t.viewMode,s=void 0===i?N.MONTH:i,c=t.unitWidth,l=void 0===c?150:c,u=[N.MINUTE,N.HOUR,N.DAY,N.WEEK].includes(s),d=function(){if(![N.MINUTE,N.HOUR,N.DAY,N.WEEK].includes(s)||0===r.length)return[];var e=[];if(s===N.MINUTE){var t=new Date(r[0]);t.setMinutes(0,0,0);var n=0;return r.forEach((function(r){r.getHours()===t.getHours()&&r.getDate()===t.getDate()&&r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear()?n+=1:(e.push({date:t,span:n}),(t=new Date(r)).setMinutes(0,0,0),n=1)})),n>0&&e.push({date:t,span:n}),e}if(s===N.HOUR){var a=new Date(r[0]);a.setHours(0,0,0,0);var o=0;return r.forEach((function(t){t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()?o+=1:(e.push({date:a,span:o}),(a=new Date(t)).setHours(0,0,0,0),o=1)})),o>0&&e.push({date:a,span:o}),e}var i=new Date(r[0]),c=0;return r.forEach((function(t){t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()?c+=1:(e.push({date:i,span:c}),i=new Date(t),c=1)})),c>0&&e.push({date:i,span:c}),e}();return e.createElement("div",{className:"rmg-timeline ".concat(o),style:{"--gantt-unit-width":"".concat(l,"px")}},u&&e.createElement("div",{className:"flex border-b border-gantt-border"},d.map((function(t,r){return e.createElement("div",{key:"higher-level-".concat(r),className:"flex-shrink-0 p-2 font-semibold text-center text-gray-800 dark:text-gray-200 border-r border-gray-200 dark:border-gray-700 h-10",style:{width:"".concat(t.span*l,"px")},"data-timeunit-higher":t.date.toISOString()},function(e){if(!(e instanceof Date))return"";switch(s){case N.MINUTE:return D(e,"HH:00",{locale:void 0});case N.HOUR:return D(e,"MMM d",{locale:void 0});case N.DAY:case N.WEEK:default:return D(e,"MMM yyyy",{locale:void 0})}}(t.date))}))),e.createElement("div",{className:"flex border-b border-gantt-border"},r.map((function(t,r){return e.createElement("div",{key:"timeunit-".concat(r),className:"".concat("w-[var(--gantt-unit-width)]"," flex-shrink-0 p-2 font-semibold text-center text-gantt-text ").concat(r===n?"bg-gantt-highlight":""," ").concat(u?"border-r border-gantt-border":""," h-10"),"data-timeunit":t.toISOString()},function(e){if(!(e instanceof Date&&w(e)))return"";switch(s){case N.MINUTE:return D(e,"HH:mm",{locale:void 0});case N.HOUR:return D(e,"HH:00",{locale:void 0});case N.DAY:return D(e,"d",{locale:void 0});case N.WEEK:var t=M(e);return"W".concat(t);case N.MONTH:return D(e,"MMM yyyy",{locale:void 0});case N.QUARTER:var r=Math.floor(e.getMonth()/3)+1;return"Q".concat(r," ").concat(e.getFullYear());case N.YEAR:return e.getFullYear().toString();default:return D(e,"MMM yyyy",{locale:void 0})}}(t))}))))},J=function(t){var r=t.currentMonthIndex,n=t.height,a=t.markerClass,o=void 0===a?"bg-red-500":a,i=t.label,s=void 0===i?"Today":i,c=t.dayOfMonth,l=t.className,u=void 0===l?"":l,d=t.viewMode,g=void 0===d?N.MONTH:d,h=t.unitWidth,m=void 0===h?150:h;if(r<0)return null;var f=function(){var e=new Date,t=c||e.getDate();switch(g){case N.MINUTE:var n=e.getMinutes(),a=e.getSeconds();return r*m+m*((n+a/60)/60);case N.HOUR:var o=e.getMinutes();return r*m+m*(o/60);case N.DAY:return r*m+m/2;case N.WEEK:var i=e.getDay();return r*m+m*((i+7)%7/6);case N.MONTH:var s=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();return r*m+m*((t-1)/s);case N.QUARTER:var l=e.getMonth()%3;return r*m+m*(l/3);case N.YEAR:var u=e.getMonth();return r*m+m*(u/12);default:return r*m+m/2}}(),v=Math.max(100,n);return e.createElement("div",{className:"absolute top-0 w-px ".concat(o," z-10 ").concat(u),style:{left:"".concat(f,"px"),height:"".concat(v,"px"),boxShadow:"0 0 4px rgba(239, 68, 68, 0.5)"},"data-testid":"today-marker"},e.createElement("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 ".concat(o," px-1.5 py-0.5 rounded text-xs text-white dark:text-white whitespace-nowrap shadow-sm")},s))},Z=function(t){var r=t.task,n=t.getTaskColor,a=t.isHovered,o=t.isDragging,i=r.color||"var(--rmg-task-bg-color)",s="",c="var(--rmg-task-text-color)";if(n){var l=n({task:r,isHovered:a,isDragging:o});i=l.backgroundColor,s=l.borderColor||"",c=l.textColor||c}var u=i.startsWith("bg-")?{}:{backgroundColor:i},d=i.startsWith("bg-")?i:"",g=s?s.startsWith("border-")?{}:{borderColor:s,borderWidth:"1px"}:{},h=s&&s.startsWith("border-")?s:"",m=c.startsWith("text-")?{}:{color:c},f=c.startsWith("text-")?c:"";return e.createElement("div",{className:"truncate select-none ".concat(d," ").concat(h," ").concat(f),style:H(H(H({},u),g),m)},r.name||"Unnamed Task")},$=function(t){var r=t.onResizeLeft,n=t.onResizeRight;return e.createElement(e.Fragment,null,e.createElement("div",{className:"rmg-resize-handle rmg-resize-handle-left",onMouseDown:r}),e.createElement("div",{className:"rmg-resize-handle rmg-resize-handle-right",onMouseDown:n}))},ee=a((function(t,r){var n=t.percent,a=t.isHovered,o=t.isDraggingProgress,i=t.editMode;t.showProgress;var s=t.onProgressClick,c=t.onProgressMouseDown;return e.createElement("div",{ref:r,className:"rmg-progress-bar",onClick:s},e.createElement("div",{className:"rmg-progress-fill",style:{width:"".concat(n,"%")}},i&&(a||o)&&e.createElement("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-1/2 h-4 w-4 rounded-full bg-white dark:bg-gray-300 border-2 border-blue-500 dark:border-blue-400 cursor-ew-resize shadow-sm hover:shadow-md transition-shadow ".concat(o?"scale-110":""),onMouseDown:c})))}));ee.displayName="ProgressBar";var te=function(a){var i=a.task,s=a.leftPx,c=a.widthPx,l=a.topPx,u=a.isHovered,d=a.isDragging,g=a.editMode,h=a.showProgress,m=void 0!==h&&h,f=a.instanceId,v=a.renderTask,D=a.getTaskColor,w=a.onMouseDown,M=a.onMouseEnter,k=a.onMouseLeave,p=a.onClick,b=a.onProgressUpdate,x=t(null),E=t(null),y=function(e){var t=e.task,a=e.progressBarRef,i=e.taskRef,s=e.editMode,c=e.showProgress,l=e.onProgressUpdate,u=r(!1),d=u[0],g=u[1],h=r(t.percent||0),m=h[0],f=h[1],v=o((function(e){s&&c&&(e.stopPropagation(),e.preventDefault(),g(!0),a.current&&(a.current.style.transition="width 0.05s ease-out"),document.addEventListener("mousemove",D),document.addEventListener("mouseup",w))}),[s,c,a]),D=o((function(e){if(d&&a.current&&i.current){var t=i.current.getBoundingClientRect(),r=t.width-2,n=Math.max(0,Math.min(r,e.clientX-t.left)),o=Math.round(n/r*100);f(Math.max(0,Math.min(100,o))),a.current&&a.current.firstChild&&(a.current.firstChild.style.width="".concat(Math.max(0,Math.min(100,o)),"%"))}}),[d,a,i]),w=o((function(){d&&(g(!1),document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",w),a.current&&(a.current.style.transition=""),l&&m!==t.percent&&l(t,m))}),[d,l,m,t,a]),M=o((function(e){if(s&&c&&l){e.stopPropagation();var r=e.currentTarget.clientWidth,n=e.nativeEvent.offsetX,a=Math.round(n/r*100);f(a),l(t,a)}}),[s,c,l,t]);return n((function(){f(t.percent||0)}),[t.percent]),n((function(){return function(){document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",w)}}),[D,w]),{progressPercent:m,isDraggingProgress:d,handleProgressMouseDown:v,handleProgressClick:M}}({task:i,progressBarRef:E,taskRef:x,editMode:g,showProgress:m,onProgressUpdate:b}),T=y.progressPercent,N=y.isDraggingProgress,A=y.handleProgressMouseDown,H=y.handleProgressClick;if(!i||!i.id)return null;if(v){var R=v({task:i,leftPx:s,widthPx:c,topPx:l,isHovered:u,isDragging:d,editMode:g,showProgress:m});return e.createElement("div",{ref:x,className:"absolute",style:{left:"".concat(Math.max(0,s),"px"),width:"".concat(Math.max(20,c),"px"),top:"".concat(l,"px")},onClick:function(e){return p(e,i)},onMouseDown:function(e){return w(e,i,"move")},onMouseEnter:function(e){return M(e,i)},onMouseLeave:k,"data-testid":"task-".concat(i.id),"data-task-id":i.id,"data-instance-id":f,"data-dragging":d?"true":"false"},R)}var C=(u||d)&&g;return e.createElement("div",{ref:x,className:"rmg-task-item",style:{left:"".concat(Math.max(0,s),"px"),width:"".concat(Math.max(20,c),"px"),top:"".concat(l,"px"),willChange:d?"transform, left, width":"auto"},onClick:function(e){return p(e,i)},onMouseDown:function(e){return w(e,i,"move")},onMouseEnter:function(e){return M(e,i)},onMouseLeave:k,"data-testid":"task-".concat(i.id),"data-task-id":i.id,"data-instance-id":f,"data-dragging":d?"true":"false"},C&&e.createElement($,{onResizeLeft:function(e){return w(e,i,"resize-left")},onResizeRight:function(e){return w(e,i,"resize-right")}}),e.createElement(Z,{task:i,getTaskColor:D,isHovered:u,isDragging:d}),m&&"number"==typeof T&&e.createElement(ee,{ref:E,percent:T,isHovered:u,isDraggingProgress:N,editMode:g,showProgress:m,onProgressClick:H,onProgressMouseDown:A}))},re=function(t){var r=t.tasks,n=void 0===r?[]:r,a=t.headerLabel,o=void 0===a?"Resources":a,i=t.showIcon,s=void 0!==i&&i,c=t.showTaskCount,l=void 0!==c&&c,u=t.showDescription,d=void 0===u||u,g=t.rowHeight,h=void 0===g?40:g,m=t.className,f=void 0===m?"":m,v=t.onGroupClick,D=t.viewMode,w=Array.isArray(n)?n:[],M=D===N.DAY||D===N.WEEK;return e.createElement("div",{className:"rmg-task-list w-40 flex-shrink-0 z-10 bg-gantt-bg shadow-sm ".concat(f)},M?e.createElement(e.Fragment,null,e.createElement("div",{className:"p-2 font-semibold text-gantt-text border-r border-b border-gantt-border h-10"}),e.createElement("div",{className:"p-2 font-semibold text-gantt-text border-r border-b border-gantt-border h-10"},o)):e.createElement("div",{className:"p-2 font-semibold text-gantt-text border-r border-b border-gantt-border h-10"},o),w.map((function(t){if(!t)return null;var r=function(e){if(!e.tasks||!Array.isArray(e.tasks))return 60;var t=O.detectOverlaps(e.tasks,D);return Math.max(60,t.length*h+20)}(t);return e.createElement("div",{key:"task-group-".concat(t.id||"unknown"),className:"p-2 border-r border-b border-gray-200 dark:border-gray-700 font-medium text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150",style:{height:"".concat(r,"px")},onClick:function(){return e=t,void(v&&v(e));var e},"data-testid":"task-group-".concat(t.id||"unknown")},e.createElement("div",{className:"flex items-center"},s&&t.icon&&e.createElement("span",{className:"mr-2",dangerouslySetInnerHTML:{__html:t.icon}}),e.createElement("div",{className:"font-medium truncate"},t.name||"Unnamed")),d&&t.description&&e.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 truncate"},t.description),l&&t.tasks&&t.tasks.length>0&&e.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},t.tasks.length," ",1===t.tasks.length?"task":"tasks"))})))},ne=function(t){var r=t.taskRows;t.taskGroup;var n=t.startDate,a=t.endDate,o=t.totalMonths,i=t.monthWidth,s=t.editMode,c=t.showProgress,l=t.hoveredTask,u=t.draggingTask,d=t.instanceId,g=t.viewMode,h=t.onMouseDown,m=t.onTaskClick,f=t.onMouseEnter,v=t.onMouseLeave,D=t.onProgressUpdate,w=t.renderTask,M=t.getTaskColor;return e.createElement(e.Fragment,null,r.map((function(t,r){return e.createElement(e.Fragment,{key:"task-row-".concat(r)},t.map((function(t){try{if(!(t&&t.id&&t.startDate instanceof Date&&t.endDate instanceof Date))return console.warn("Invalid task data:",t),null;var k=W.calculateTaskPixelPosition(t,n,a,o,i,g),p=k.leftPx,b=k.widthPx,x=(null==l?void 0:l.id)===t.id,E=(null==u?void 0:u.id)===t.id,y=40*r+10;return e.createElement(te,{key:"task-".concat(t.id),task:t,leftPx:p,widthPx:b,topPx:y,isHovered:x,isDragging:E,editMode:s,showProgress:c,instanceId:d,onMouseDown:h,onMouseEnter:f,onMouseLeave:v,onClick:m,renderTask:w,getTaskColor:M,onProgressUpdate:D})}catch(e){return console.error("Error rendering task:",e),null}})))})))},ae=function(e){var a=e.taskGroup,i=e.startDate,s=e.endDate,c=e.editMode,l=e.viewMode,u=e.monthWidth,d=e.totalMonths,g=e.onTaskUpdate,h=e.onTaskClick,m=e.onTaskSelect,f=e.rowRef,v=e.instanceId,D=e.smoothDragging,w=e.animationSpeed,M=r(null),k=M[0],p=M[1],b=r(null),x=b[0],E=b[1],y=r(null),T=y[0],A=y[1],R=r(0),C=R[0],Y=R[1],U=r({x:0,y:0}),S=U[0],P=U[1],F=r(null),L=F[0],O=F[1],I=r(null),z=I[0],V=I[1],B=t(null),q=t({x:0,y:0}),K=t(null),G=t(null),Q=t({left:0,width:0}),_=t(0),X=t(null),j=t(null),J=t(null),Z=D&&l!==N.DAY,$=function(e){var t=H(H({},e),{startDate:new Date(e.startDate),endDate:new Date(e.endDate)});O(t),j.current=t},ee=o((function(){if(J.current&&K.current&&G.current){var e=Date.now(),t=e-_.current;_.current=e;var r=w||.25,n=G.current.left+(K.current.left-G.current.left)*r,a=G.current.width+(K.current.width-G.current.width)*r;Q.current.left=(n-G.current.left)/(t||16),Q.current.width=(a-G.current.width)/(t||16),G.current={left:n,width:a},J.current.style.left="".concat(n,"px"),J.current.style.width="".concat(a,"px"),X.current&&te(n,a),B.current=requestAnimationFrame(ee)}else B.current=null}),[w]),te=o((function(e,t){if(X.current)try{if(l===N.DAY){var r=Math.round(e/u),n=Math.max(1,Math.round(t/u)),a=new Date(i);a.setHours(0,0,0,0),(v=new Date(a)).setDate(a.getDate()+r),v.setHours(0,0,0,0),(D=new Date(v)).setDate(v.getDate()+n-1),D.setHours(23,59,59,999);var o=i.getTime(),c=s.getTime(),g=new Date(Math.max(o,v.getTime())),h=new Date(Math.min(c,D.getTime())),m=H(H({},X.current),{startDate:g,endDate:h});$(m)}else{var f=W.calculateDatesFromPosition(e,t,i,s,d,u,l),v=f.newStartDate,D=f.newEndDate;m=H(H({},X.current),{startDate:v,endDate:D});$(m)}}catch(e){console.error("Error updating dates:",e)}}),[X,u,i,s,d,l]),re=o((function(){if(J.current&&K.current&&X.current){var e=K.current.left,t=K.current.width;l===N.DAY?(e=Math.round(e/u)*u,t=Math.round(t/u)*u,t=Math.max(u,t),J.current.style.transition="transform 0.15s ease-out, left 0.15s ease-out, width 0.15s ease-out",J.current.style.left="".concat(e,"px"),J.current.style.width="".concat(t,"px"),te(e,t)):Z||(J.current.style.transition="transform 0.15s ease-out, left 0.15s ease-out, width 0.15s ease-out",J.current.style.left="".concat(e,"px"),J.current.style.width="".concat(t,"px"));var r=j.current;if(r){var n=i.getTime(),o=s.getTime();if(r.startDate.getTime()<n&&(r=H(H({},r),{startDate:new Date(n)})),r.endDate.getTime()>o&&(r=H(H({},r),{endDate:new Date(o)})),g&&r)try{g(a.id,r)}catch(e){console.error("Error in onTaskUpdate:",e)}}}}),[J,K,X,j,l,u,Z,i,s,g,a.id,te]),ne=o((function(e,t){h&&!x&&h(t,a),m&&m(t,!0)}),[h,m,x,a]),ae=o((function(e,t){x||(p(t),ie(e))}),[x]),oe=o((function(){x||p(null)}),[x]),ie=o((function(e){if(f.current){var t=f.current.getBoundingClientRect();P({x:e.clientX-t.left+20,y:e.clientY-t.top})}}),[f]),se=o((function(e,t,r){if(c){e.preventDefault(),e.stopPropagation();var n=document.querySelector('[data-task-id="'.concat(t.id,'"][data-instance-id="').concat(v,'"]'));if(n){J.current=n;var a=parseFloat(n.style.left||"0"),o=parseFloat(n.style.width||"0");V({left:a,width:o,startDate:new Date(t.startDate),endDate:new Date(t.endDate)}),K.current={left:a,width:o},G.current={left:a,width:o},q.current={x:e.clientX,y:e.clientY},_.current=Date.now(),Q.current={left:0,width:0},n.setAttribute("data-dragging","true"),n.style.transition="none",E(t),A(r),Y(e.clientX),O(t),function(e){var t=H(H({},e),{startDate:new Date(e.startDate),endDate:new Date(e.endDate)});E(t),X.current=t}(t),$(t),null===B.current&&Z&&(B.current=requestAnimationFrame(ee)),document.addEventListener("mouseup",le),document.addEventListener("mousemove",ce)}}}),[c,v,Z,ee]),ce=o((function(e){if(q.current={x:e.clientX,y:e.clientY},e instanceof MouseEvent&&k&&f.current){var t=f.current.getBoundingClientRect();P({x:e.clientX-t.left+20,y:e.clientY-t.top})}else e instanceof MouseEvent||ie(e);if(x&&T&&z&&f.current&&K.current)try{var r=e.clientX-C,n=d*u,a=K.current.left,o=K.current.width;switch(T){case"move":a=Math.max(0,Math.min(n-z.width,z.left+r)),l===N.DAY&&(a=Math.round(a/u)*u);break;case"resize-left":var i=z.width-20,s=Math.min(i,r);a=Math.max(0,z.left+s),l===N.DAY&&(a=Math.round(a/u)*u);var c=z.left+z.width;o=Math.max(20,c-a),l===N.DAY&&(o=Math.round(o/u)*u,o=Math.max(u,o));break;case"resize-right":o=Math.max(20,Math.min(n-z.left,z.width+r)),l===N.DAY&&(o=Math.round(o/u)*u,o=Math.max(u,o))}K.current={left:a,width:o},l===N.DAY&&J.current?(J.current.style.left="".concat(a,"px"),J.current.style.width="".concat(o,"px"),te(a,o)):Z?null===B.current&&(_.current=Date.now(),B.current=requestAnimationFrame(ee)):J.current&&(J.current.style.left="".concat(a,"px"),J.current.style.width="".concat(o,"px"),te(a,o))}catch(e){console.error("Error in handleMouseMove:",e)}}),[x,T,z,l,ie,C,d,u,Z,te,f,k,ee]),le=o((function(){try{null!==B.current&&(cancelAnimationFrame(B.current),B.current=null),re(),J.current&&(J.current.setAttribute("data-dragging","false"),setTimeout((function(){J.current&&(J.current.style.transition="")}),200))}catch(e){console.error("Error in handleMouseUp:",e)}finally{E(null),A(null),O(null),V(null),X.current=null,j.current=null,J.current=null,K.current=null,G.current=null,document.removeEventListener("mouseup",le),document.removeEventListener("mousemove",ce)}}),[re,ce]),ue=o((function(e,t){if(g&&a.id)try{var r=H(H({},e),{percent:t});g(a.id,r)}catch(e){console.error("Error updating task progress:",e)}}),[g,a.id]);return n((function(){return function(){null!==B.current&&(cancelAnimationFrame(B.current),B.current=null)}}),[]),{hoveredTask:k,draggingTask:x,dragType:T,previewTask:L,tooltipPosition:S,initialTaskState:z,handleMouseDown:se,handleMouseMove:ce,handleMouseUp:le,handleTaskClick:ne,handleTaskMouseEnter:ae,handleTaskMouseLeave:oe,handleProgressUpdate:ue}},oe=function(r){var a=r.taskGroup,s=r.startDate,c=r.endDate,l=r.totalMonths,u=r.monthWidth,d=r.editMode,g=void 0===d||d,h=r.showProgress,m=void 0!==h&&h,f=r.className,v=void 0===f?"":f,D=r.tooltipClassName,w=void 0===D?"":D,M=r.onTaskUpdate,k=r.onTaskClick,p=r.onTaskSelect,b=r.onAutoScrollChange,x=r.viewMode,E=r.scrollContainerRef,y=r.smoothDragging,T=void 0===y||y;r.movementThreshold;var N=r.animationSpeed,A=void 0===N?.25:N,H=r.renderTask,R=r.renderTooltip,C=r.getTaskColor;if(!a||!a.id||!Array.isArray(a.tasks))return e.createElement("div",{className:"relative h-16 text-gantt-text"},"Invalid task group data");var Y=s instanceof Date?s:new Date,U=c instanceof Date?c:new Date,S=e.useId(),P=e.useRef(null),F=ae({taskGroup:a,startDate:Y,endDate:U,editMode:g,viewMode:x,monthWidth:u,totalMonths:l,onTaskUpdate:M,onTaskClick:k,onTaskSelect:p,rowRef:P,instanceId:S,smoothDragging:T,animationSpeed:A}),L=F.hoveredTask,W=F.draggingTask,I=F.dragType,z=F.previewTask,V=F.tooltipPosition,B=F.handleMouseDown,q=F.handleMouseMove,K=F.handleMouseUp,G=F.handleTaskClick,_=F.handleTaskMouseEnter,X=F.handleTaskMouseLeave,j=F.handleProgressUpdate,J=function(e){var r=e.scrollContainerRef,a=e.draggingTask,i=e.onAutoScrollChange,s=e.totalMonths,c=e.monthWidth,l=t(!1),u=t(null),d=t(0),g=t(null),h=t({minLeft:0,maxLeft:s*c}),m=o((function(e){if((null==r?void 0:r.current)&&a){var t=r.current.getBoundingClientRect(),n=null,o=0;e<t.left+40?(n="left",o=Math.max(1,Math.round((40-(e-t.left))/10))):e>t.right-40&&(n="right",o=Math.max(1,Math.round((e-(t.right-40))/10))),g.current=n,d.current=o,n&&!l.current?(f(),i&&i(!0)):!n&&l.current&&(v(),i&&i(!1))}}),[r,a,i]),f=o((function(){if(!l.current){l.current=!0;var e=function(){if(l.current&&(null==r?void 0:r.current)){var t=r.current,n=g.current,a=d.current,o=t.scrollLeft,i=t.scrollWidth-t.clientWidth;if("left"===n){if(o<=0)return void v();var s=Math.max(0,o-a);t.scrollLeft=s}else if("right"===n){if(o>=i)return void v();s=Math.min(i,o+a),t.scrollLeft=s}l.current&&(u.current=requestAnimationFrame(e))}};u.current=requestAnimationFrame(e)}}),[r]),v=o((function(){l.current=!1,null!==u.current&&(cancelAnimationFrame(u.current),u.current=null),i&&i(!1)}),[i]);return n((function(){h.current={minLeft:0,maxLeft:s*c}}),[s,c]),n((function(){return function(){v()}}),[v]),{checkForAutoScroll:m,startAutoScroll:f,stopAutoScroll:v,isAutoScrolling:l.current}}({scrollContainerRef:E,draggingTask:W,onAutoScrollChange:b,totalMonths:l,monthWidth:u}).checkForAutoScroll,Z=function(e){var t=e.tasks,r=e.previewTask,n=e.viewMode,a=i((function(){return r?O.getPreviewArrangement(r,t,n):O.detectOverlaps(t,n)}),[t,r,n]),o=i((function(){return Math.max(60,40*a.length+20)}),[a.length]);return{taskRows:a,rowHeight:o}}({tasks:a.tasks,previewTask:z,viewMode:x}),$=Z.taskRows,ee=Z.rowHeight;return e.useEffect((function(){return function(){document.removeEventListener("mouseup",K),document.removeEventListener("mousemove",q)}}),[K,q]),a.tasks&&0!==a.tasks.length?e.createElement("div",{className:"relative border-b border-gray-200 dark:border-gray-700 text-gantt-task-text ".concat(v),style:{height:"".concat(ee,"px")},onMouseMove:function(e){q(e),W&&(null==E?void 0:E.current)&&J(e.clientX)},onMouseLeave:function(){return X()},ref:P,"data-testid":"task-row-".concat(a.id),"data-instance-id":S},e.createElement(ne,{taskRows:$,taskGroup:a,startDate:Y,endDate:U,totalMonths:l,monthWidth:u,editMode:g,showProgress:m,hoveredTask:L,draggingTask:W,onMouseDown:B,onTaskClick:G,onMouseEnter:_,onMouseLeave:X,onProgressUpdate:j,instanceId:S,viewMode:x,renderTask:H,getTaskColor:C}),(L||W)&&e.createElement(Q,{task:z||W||L,position:V,dragType:I,taskId:null==W?void 0:W.id,startDate:Y,endDate:U,totalMonths:l,monthWidth:u,showProgress:m,instanceId:S,className:w,viewMode:x,renderTooltip:R})):e.createElement("div",{className:"relative h-16 text-gantt-text"},"No tasks available")},ie=function(t){var r=t.tasks,n=t.startDate,a=t.endDate,o=t.timeUnits,i=t.totalUnits,s=t.currentUnitIndex,c=t.viewMode,l=t.editMode,u=t.headerLabel,d=t.showProgress,g=t.showCurrentDateMarker,h=t.todayLabel,m=t.currentDate,f=t.locale,v=t.unitWidth,D=t.smoothDragging,w=t.movementThreshold,M=t.animationSpeed,k=t.rowHeight,p=t.renderTaskList,b=t.renderTask,x=t.renderTooltip,E=t.renderTimelineHeader,y=t.getTaskColor,T=t.onTaskUpdate,N=t.onTaskClick,A=t.onTaskSelect;t.onTaskDoubleClick;var H=t.onGroupClick,R=t.scrollContainerRef,C=t.styles,Y=e.useState(!1),U=Y[0],S=Y[1],P=function(e){S(e),R.current&&(e?R.current.classList.add("rmg-auto-scrolling"):R.current.classList.remove("rmg-auto-scrolling"))};return e.createElement("div",{className:"relative flex"},p?p({tasks:r,headerLabel:u,onGroupClick:H,viewMode:c}):e.createElement(re,{tasks:r,headerLabel:u,onGroupClick:H,className:C.taskList||"",viewMode:c}),e.createElement("div",{ref:R,className:"flex-grow overflow-x-auto rmg-gantt-scroll-container ".concat(U?"rmg-auto-scrolling":"")},e.createElement("div",{className:"min-w-max"},E?E({timeUnits:o,currentUnitIndex:s,viewMode:c,locale:f,unitWidth:v}):e.createElement(j,{months:o,currentMonthIndex:s,locale:f,className:C.timeline||"",viewMode:c,unitWidth:v}),e.createElement("div",{className:"relative"},g&&s>=0&&e.createElement(J,{currentMonthIndex:s,height:r.reduce((function(e,t){if(!t||!Array.isArray(t.tasks))return e+60;var r=O.detectOverlaps(t.tasks,c);return e+Math.max(60,r.length*k+20)}),0),label:h,dayOfMonth:m.getDate(),className:C.todayMarker||"",viewMode:c,unitWidth:v}),r.map((function(t){return t&&t.id?e.createElement(oe,{key:"task-row-".concat(t.id),taskGroup:t,startDate:n,endDate:a,totalMonths:i,monthWidth:v,editMode:l,showProgress:d,onTaskUpdate:T,onTaskClick:N,onTaskSelect:A,onAutoScrollChange:P,className:C.taskRow||"",tooltipClassName:C.tooltip||"",viewMode:c,scrollContainerRef:R,smoothDragging:D,movementThreshold:w,animationSpeed:M,renderTask:b,renderTooltip:x,getTaskColor:y}):null}))))))},se=s({theme:R,isDarkMode:!1}),ce=function(t){var r=t.children,n=t.theme,a=void 0===n?{}:n,o=t.darkMode,i=void 0!==o&&o,s=P(a,i);return e.createElement(se.Provider,{value:{theme:s,isDarkMode:i}},r)},le=function(){return c(se)};function ue(e){if(!Array.isArray(e)||0===e.length)return new Date;var t=new Date,r=!1;if(e.forEach((function(e){e&&Array.isArray(e.tasks)&&e.tasks.forEach((function(e){e&&e.startDate instanceof Date&&(r?e.startDate<t&&(t=new Date(e.startDate)):(t=new Date(e.startDate),r=!0))}))})),!r){var n=new Date;return new Date(n.getFullYear(),n.getMonth()-1,1)}return new Date(t.getFullYear(),t.getMonth(),1)}function de(e){if(!Array.isArray(e)||0===e.length)return new Date;var t=new Date,r=!1;if(e.forEach((function(e){e&&Array.isArray(e.tasks)&&e.tasks.forEach((function(e){e&&e.endDate instanceof Date&&(r?e.endDate>t&&(t=new Date(e.endDate)):(t=new Date(e.endDate),r=!0))}))})),!r){var n=new Date;return new Date(n.getFullYear(),n.getMonth()+2,0)}return new Date(t.getFullYear(),t.getMonth()+1,0)}function ge(e,t,r){if(!(e.startDate instanceof Date&&e.endDate instanceof Date))return{left:"0%",width:"10%"};var n=V(new Date(t.getFullYear(),t.getMonth(),1),new Date(r.getFullYear(),r.getMonth()+1,0)),a=n.length,o=e.startDate.getFullYear(),i=e.startDate.getMonth(),s=n.findIndex((function(e){return e.getFullYear()===o&&e.getMonth()===i})),c=s<0?0:s,l=e.endDate.getFullYear(),u=e.endDate.getMonth(),d=n.findIndex((function(e){return e.getFullYear()===l&&e.getMonth()===u})),g=((d<0?n.length-1:d)-c+1)/a*100;return{left:"".concat(c/a*100,"%"),width:"".concat(g,"%")}}function he(e){if(!Array.isArray(e))return[];var t=e.filter((function(e){return e&&e.startDate instanceof Date&&e.endDate instanceof Date}));if(0===t.length)return[];var r=[];return t.forEach((function(e){for(var t=!1,n=0;n<r.length;n++){if(!r[n].some((function(t){return!(e.startDate>=t.endDate||e.endDate<=t.startDate)}))){r[n].push(e),t=!0;break}}t||r.push([e])})),r}var me=function(e){var t=e.customStartDate,r=e.customEndDate,n=e.tasks,a=e.activeViewMode,o=e.currentDate,s=e.minuteStep,c=void 0===s?5:s,l=i((function(){return t||ue(n)}),[t,n]),u=i((function(){return r||de(n)}),[r,n]),d=i((function(){return function(e,t,r,n){switch(r){case N.MINUTE:return function(e,t,r){void 0===r&&(r=5);var n=[],a=new Date(e);a.setSeconds(0,0);var o=a.getMinutes(),i=Math.floor(o/r)*r;a.setMinutes(i);var s=new Date(t);s.setMinutes(s.getMinutes(),59,999);for(;a<=s;)n.push(new Date(a)),a=T(a,r);return n}(e,t,n);case N.HOUR:return function(e,t){var r=[],n=new Date(e);n.setMinutes(0,0,0);var a=new Date(t);a.setHours(a.getHours(),59,59,999);for(;n<=a;)r.push(new Date(n)),n=y(n,1);return r}(e,t);case N.DAY:return function(e,t){var r=[],n=new Date(e);n.setHours(0,0,0,0);var a=new Date(t);a.setHours(23,59,59,999);for(;n<=a;)r.push(new Date(n)),n=E(n,1);return r}(e,t);case N.WEEK:return function(e,t){var r=[],n=new Date(e);for(;n<=t;)r.push(new Date(n)),n=E(n,7);return r}(e,t);case N.MONTH:return V(e,t);case N.QUARTER:return function(e,t){var r=[],n=b(new Date(e));for(;n<=t;)r.push(new Date(n)),n=x(n,1);return r}(e,t);case N.YEAR:return function(e,t){var r=[],n=k(new Date(e));for(;n<=t;)r.push(new Date(n)),n=p(n,1);return r}(e,t);default:return V(e,t)}}(l,u,a,c)}),[l,u,a,c]),g=d.length,h=i((function(){return function(e,t,r,n){var a=new Date(t);switch(r){case N.MINUTE:return e.findIndex((function(e){return e.getHours()===a.getHours()&&Math.floor(e.getMinutes()/n)===Math.floor(a.getMinutes()/n)&&e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()}));case N.HOUR:return e.findIndex((function(e){return e.getHours()===a.getHours()&&e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()}));case N.DAY:return e.findIndex((function(e){return e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()}));case N.WEEK:return e.findIndex((function(e){var t=new Date(e);return t.setDate(e.getDate()+6),a>=e&&a<=t}));case N.MONTH:return e.findIndex((function(e){return e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()}));case N.QUARTER:var o=Math.floor(a.getMonth()/3);return e.findIndex((function(e){return Math.floor(e.getMonth()/3)===o&&e.getFullYear()===a.getFullYear()}));case N.YEAR:return e.findIndex((function(e){return e.getFullYear()===a.getFullYear()}));default:return-1}}(d,o,a,c)}),[d,o,a,c]);return{derivedStartDate:l,derivedEndDate:u,timeUnits:d,totalUnits:g,currentUnitIndex:h}};var fe=function(n){var a=n.tasks,s=void 0===a?[]:a,c=n.startDate,l=n.endDate,u=n.title,d=void 0===u?"Project Timeline":u,g=n.currentDate,h=void 0===g?new Date:g,m=n.showCurrentDateMarker,f=void 0===m||m,v=n.todayLabel,D=void 0===v?"Today":v,w=n.editMode,M=void 0===w||w,k=n.headerLabel,p=void 0===k?"Resources":k,b=n.showProgress,x=void 0!==b&&b,E=n.darkMode,y=void 0!==E&&E,T=n.locale,A=void 0===T?"default":T,H=n.viewMode,R=n.viewModes,C=n.smoothDragging,Y=void 0===C||C,U=n.movementThreshold,S=void 0===U?3:U,P=n.animationSpeed,F=void 0===P?.25:P,L=n.renderTaskList,O=n.renderTask,W=n.renderTooltip,I=n.renderViewModeSelector,z=n.renderHeader,V=n.renderTimelineHeader,B=n.getTaskColor,q=n.onTaskUpdate,K=n.onTaskClick,G=n.onTaskSelect,Q=n.onTaskDoubleClick,_=n.onGroupClick,j=n.onViewModeChange,J=n.fontSize,Z=n.rowHeight,$=void 0===Z?40:Z,ee=n.styles,te=void 0===ee?{}:ee,re=t(null),ne=t(null),ae=le(),oe=ae.theme,se=ae.isDarkMode,ce=function(e){var t=e.initialViewMode,n=void 0===t?N.MONTH:t,a=e.viewModes,s=e.onViewModeChange,c=r(n),l=c[0],u=c[1],d=i((function(){return!1!==a&&(Array.isArray(a)?a:[N.DAY,N.WEEK,N.MONTH,N.QUARTER,N.YEAR])}),[a]),g=!1!==d;return{activeViewMode:l,handleViewModeChange:o((function(e){u(e),s&&s(e)}),[s]),shouldShowViewModeSelector:g,availableViewModes:d}}({initialViewMode:H,viewModes:R,onViewModeChange:j}),ue=ce.activeViewMode,de=ce.handleViewModeChange,ge=ce.shouldShowViewModeSelector,he=ce.availableViewModes,fe=me({customStartDate:c,customEndDate:l,tasks:s,activeViewMode:ue,currentDate:h}),ve=fe.derivedStartDate,De=fe.derivedEndDate,we=fe.timeUnits,Me=fe.totalUnits,ke=fe.currentUnitIndex,pe=oe.sizes.unitWidth[ue]||150;return e.createElement("div",{ref:re,className:"rmg-gantt-chart w-full border border-gantt-border bg-gantt-bg text-gantt-text rounded-xl shadow-lg overflow-hidden ".concat(se?"dark":""," ").concat(te.container||""),style:{fontSize:J||oe.sizes.fontSize,"--gantt-unit-width":"".concat(pe,"px")},"data-testid":"gantt-chart"},e.createElement(X,{title:d,darkMode:y,activeViewMode:ue,onViewModeChange:de,showViewModeSelector:ge,availableViewModes:he,renderHeader:z,renderViewModeSelector:I,styles:te}),e.createElement(ie,{tasks:s,startDate:ve,endDate:De,timeUnits:we,totalUnits:Me,currentUnitIndex:ke,viewMode:ue,editMode:M,headerLabel:p,showProgress:x,showCurrentDateMarker:f,todayLabel:D,currentDate:h,locale:A,unitWidth:pe,smoothDragging:Y,movementThreshold:S,animationSpeed:F,rowHeight:$,renderTaskList:L,renderTask:O,renderTooltip:W,renderTimelineHeader:V,getTaskColor:B,onTaskUpdate:q,onTaskClick:K,onTaskSelect:G,onTaskDoubleClick:Q,onGroupClick:_,scrollContainerRef:ne,styles:te}))};export{F as A,L as B,O as C,A as D,fe as G,te as T,_ as V,H as _,re as a,oe as b,j as c,J as d,Q as e,ce as f,N as g,W as h,z as i,I as j,V as k,B as l,K as m,G as n,q as o,ue as p,de as q,ge as r,he as s,R as t,le as u,C as v,Y as w,U as x,S as y,P as z};
//# sourceMappingURL=GanttChart-DqwsIiG_.js.map
