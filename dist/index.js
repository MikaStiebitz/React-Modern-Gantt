"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a,n,r=t(e),o=function(){return o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};function i(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}function s(e,t,a){if(void 0===t&&(t=exports.DateDisplayFormat.FULL_DATE),void 0===a&&(a="default"),!(e instanceof Date)||isNaN(e.getTime()))return"Invalid date";switch(t){case exports.DateDisplayFormat.MONTH_YEAR:return e.toLocaleString(a,{month:"short",year:"2-digit"});case exports.DateDisplayFormat.SHORT_DATE:return e.toLocaleString(a,{month:"short",day:"numeric"});case exports.DateDisplayFormat.FULL_DATE:default:return e.toLocaleString(a,{month:"short",day:"numeric",year:"numeric"})}}function l(e,t){var a=[];if(!(e instanceof Date&&t instanceof Date))return console.warn("getMonthsBetween: Invalid date parameters"),[new Date];for(var n=e.getFullYear(),r=e.getMonth(),o=t.getFullYear(),i=t.getMonth(),s=n;s<=o;s++)for(var l=s===o?i:11,c=s===n?r:0;c<=l;c++)a.push(new Date(s,c,1));return a}function c(e){if(!Array.isArray(e))return console.warn("detectTaskOverlaps: Invalid tasks array"),[];var t=e.filter((function(e){return e&&e.startDate instanceof Date&&e.endDate instanceof Date}));if(0===t.length)return[];var a=[];return t.forEach((function(e){for(var t=!1,n=0;n<a.length;n++){if(!a[n].some((function(t){return!(e.startDate>=t.endDate||e.endDate<=t.startDate)}))){a[n].push(e),t=!0;break}}t||a.push([e])})),a}function d(e){if(!Array.isArray(e)||0===e.length)return new Date;var t=new Date,a=!1;if(e.forEach((function(e){e&&Array.isArray(e.tasks)&&e.tasks.forEach((function(e){e&&e.startDate instanceof Date&&(a?e.startDate<t&&(t=new Date(e.startDate)):(t=new Date(e.startDate),a=!0))}))})),!a){var n=new Date;return new Date(n.getFullYear(),n.getMonth()-1,1)}return new Date(t.getFullYear(),t.getMonth(),1)}function u(e){if(!Array.isArray(e)||0===e.length)return new Date;var t=new Date,a=!1;if(e.forEach((function(e){e&&Array.isArray(e.tasks)&&e.tasks.forEach((function(e){e&&e.endDate instanceof Date&&(a?e.endDate>t&&(t=new Date(e.endDate)):(t=new Date(e.endDate),a=!0))}))})),!a){var n=new Date;return new Date(n.getFullYear(),n.getMonth()+2,0)}return new Date(t.getFullYear(),t.getMonth()+1,0)}"function"==typeof SuppressedError&&SuppressedError,exports.DateDisplayFormat=void 0,(a=exports.DateDisplayFormat||(exports.DateDisplayFormat={})).MONTH_YEAR="month-year",a.FULL_DATE="full-date",a.SHORT_DATE="short-date",exports.ViewMode=void 0,(n=exports.ViewMode||(exports.ViewMode={})).DAY="day",n.WEEK="week",n.MONTH="month",n.QUARTER="quarter",n.YEAR="year";var f=function(){function e(){}return e.detectOverlaps=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=[];return e.forEach((function(e){for(var a=!1,n=0;n<t.length;n++){if(!t[n].some((function(t){return!(e.startDate>=t.endDate||e.endDate<=t.startDate)}))){t[n].push(e),a=!0;break}}a||t.push([e])})),t},e.wouldCollide=function(e,t,a){return t.some((function(t){return t.id!==e.id&&t.id!==a&&!(e.startDate>=t.endDate||e.endDate<=t.startDate)}))},e.getPreviewArrangement=function(e,t){var a=t.map((function(t){return t.id===e.id?e:t}));return this.detectOverlaps(a)},e}(),m=function(){function e(){}return e.calculateDatesFromPosition=function(e,t,a,n,r,o){try{var i=isNaN(e)?0:e,s=isNaN(t)||t<20?20:t,l=a.getTime(),c=(n.getTime()-l)/(r*o),d=i*c,u=s*c,f=new Date(l+d),m=new Date(l+d+u);if(f<a){var g=m.getTime()-f.getTime();return{newStartDate:new Date(a),newEndDate:new Date(a.getTime()+g)}}if(m>n){g=m.getTime()-f.getTime();return{newStartDate:new Date(n.getTime()-g),newEndDate:new Date(n)}}return{newStartDate:f,newEndDate:m}}catch(e){return console.error("Error calculating dates from position:",e),{newStartDate:new Date(a),newEndDate:new Date(n)}}},e.createUpdatedTask=function(e,t,a){return o(o({},e),{startDate:new Date(t),endDate:new Date(a)})},e.calculateTaskPixelPosition=function(e,t,a,n,r){try{if(!(e.startDate instanceof Date&&e.endDate instanceof Date))throw new Error("Invalid dates in task");var o=Math.max(e.startDate.getTime(),t.getTime()),i=Math.min(e.endDate.getTime(),a.getTime()),s=t.getTime(),l=a.getTime()-s,c=(i-o)/l*100;return{leftPx:(o-s)/l*100/100*n*r,widthPx:Math.max(20,c/100*n*r)}}catch(t){return console.error("Error calculating task position:",t,e),{leftPx:0,widthPx:20}}},e.getLiveDatesFromElement=function(e,t,a,n,r){try{if(!e)return{startDate:new Date(t),endDate:new Date(a)};var o=parseFloat(e.style.left||"0"),i=parseFloat(e.style.width||"0"),s=this.calculateDatesFromPosition(o,i,t,a,n,r);return{startDate:s.newStartDate,endDate:s.newEndDate}}catch(e){return console.error("Error getting live dates:",e),{startDate:new Date(t),endDate:new Date(a)}}},e.formatDate=function(e,t){return void 0===t&&(t="default"),e instanceof Date&&!isNaN(e.getTime())?e.toLocaleDateString(t,{year:"numeric",month:"short",day:"numeric"}):"Invalid date"},e.getDuration=function(e,t){try{if(!(e instanceof Date)||!(t instanceof Date)||isNaN(e.getTime())||isNaN(t.getTime()))return 0;var a=e<t?e:t,n=e<t?t:e,r=Math.abs(n.getTime()-a.getTime());return Math.ceil(r/864e5)}catch(e){return console.error("Error calculating duration:",e),0}},e.getMonthName=function(e,t){return void 0===t&&(t="default"),e instanceof Date&&!isNaN(e.getTime())?e.toLocaleString(t,{month:"short"}):""},e.getDaysInMonth=function(e){return e instanceof Date&&!isNaN(e.getTime())?new Date(e.getFullYear(),e.getMonth()+1,0).getDate():30},e.datesOverlap=function(e,t,a,n){return e<=n&&t>=a},e}(),g=function(e){var t=e.task,a=e.leftPx,n=e.widthPx,o=e.topPx,i=e.isHovered,s=e.isDragging,l=e.editMode,c=e.showProgress,d=void 0!==c&&c,u=e.instanceId,f=e.onMouseDown,m=e.onMouseEnter,g=e.onMouseLeave,h=e.onClick,v=(i||s)&&l;if(!t||!t.id)return console.warn("TaskItem: Invalid task data",t),null;var p=t.color||"bg-gantt-task";return r.default.createElement("div",{className:"absolute h-8 rounded ".concat(p," flex items-center px-2 text-xs text-gantt-task-text font-medium ").concat(l?"cursor-move":"cursor-pointer"),style:{left:"".concat(Math.max(0,a),"px"),width:"".concat(Math.max(20,n),"px"),top:"".concat(o,"px")},onClick:function(e){return h(e,t)},onMouseDown:function(e){return f(e,t,"move")},onMouseEnter:function(e){return m(e,t)},onMouseLeave:g,"data-testid":"task-".concat(t.id),"data-task-id":t.id,"data-instance-id":u},v&&r.default.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 dark:bg-opacity-40 cursor-ew-resize rounded-l",onMouseDown:function(e){e.stopPropagation(),f(e,t,"resize-left")}}),r.default.createElement("div",{className:"truncate select-none"},t.name||"Unnamed Task"),d&&"number"==typeof t.percent&&r.default.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 dark:bg-opacity-30 rounded-full overflow-hidden"},r.default.createElement("div",{className:"h-full bg-white dark:bg-gray-200 rounded-full",style:{width:"".concat(t.percent,"%")}})),v&&r.default.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 dark:bg-opacity-40 cursor-ew-resize rounded-r",onMouseDown:function(e){e.stopPropagation(),f(e,t,"resize-right")}}))},h=function(e){var t=e.task,a=e.position,n=e.dragType,o=e.taskId,i=e.startDate,s=e.endDate,l=e.totalMonths,c=e.monthWidth,d=e.showProgress,u=void 0!==d&&d,f=e.instanceId,g=e.className,h=void 0===g?"":g,v=t.startDate,p=t.endDate;try{var D=o||t.id,k=document.querySelector('[data-task-id="'.concat(D,'"][data-instance-id="').concat(f,'"]'));if(k&&(n||k.style.left||k.style.width)){var x=m.getLiveDatesFromElement(k,i,s,l,c);v=x.startDate,p=x.endDate}}catch(e){console.error("Error calculating live dates for tooltip:",e)}var w=m.getDuration(v,p),b=function(e){return m.formatDate(e)},y=function(){if(!n)return null;switch(n){case"move":return"Moving task...";case"resize-left":return"Adjusting start date...";case"resize-right":return"Adjusting end date...";default:return null}}();return r.default.createElement("div",{className:"rmg-task-tooltip absolute z-20 bg-[var(--rmg-tooltip-bg,#ffffff)] text-[var(--rmg-tooltip-text,#1f2937)] border border-[var(--rmg-tooltip-border,#e5e7eb)] dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 rounded-md shadow-md p-2 text-xs select-none ".concat(h),style:{left:"".concat(a.x,"px"),top:"".concat(a.y-40,"px"),minWidth:"150px"}},r.default.createElement("div",{className:"font-bold mb-1"},t.name||"Unnamed Task"),y&&r.default.createElement("div",{className:"text-xs text-blue-500 dark:text-blue-400 mb-1 italic"},y),r.default.createElement("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1"},r.default.createElement("div",{className:"font-semibold"},"Start:"),r.default.createElement("div",null,b(v)),r.default.createElement("div",{className:"font-semibold"},"End:"),r.default.createElement("div",null,b(p)),r.default.createElement("div",{className:"font-semibold"},"Duration:"),r.default.createElement("div",null,w," day",1!==w?"s":""),u&&"number"==typeof t.percent&&r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"font-semibold"},"Progress:"),r.default.createElement("div",null,t.percent,"%")),t.dependencies&&t.dependencies.length>0&&r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"font-semibold"},"Dependencies:"),r.default.createElement("div",null,t.dependencies.join(", ")))))},v=function(t){var a=t.taskGroup,n=t.startDate,o=t.endDate,i=t.totalMonths,s=t.monthWidth,l=t.editMode,c=void 0===l||l,d=t.showProgress,u=void 0!==d&&d,v=t.onTaskUpdate,p=t.onTaskClick,D=t.onTaskSelect;if(!a||!a.id||!Array.isArray(a.tasks))return console.warn("TaskRow: Invalid task group data",a),r.default.createElement("div",{className:"relative h-16 text-gantt-text"},"Invalid task group data");var k=n instanceof Date?n:new Date,x=o instanceof Date?o:new Date,w=e.useState(null),b=w[0],y=w[1],E=e.useState(null),M=E[0],T=E[1],N=e.useState(null),S=N[0],F=N[1],P=e.useState(0),A=P[0],I=P[1],L=e.useState({x:0,y:0}),C=L[0],R=L[1],Y=e.useState(null),O=Y[0],z=Y[1],G=e.useRef(null),U=e.useRef(null),H=e.useRef(null),_=e.useRef("task-row-".concat(Math.random().toString(36).substring(2,11))),W=function(e){z(e),H.current=e},j=O?f.getPreviewArrangement(O,a.tasks):f.detectOverlaps(a.tasks),B=Math.max(60,40*j.length+20),X=function(e,t){p&&!M&&p(t,a),D&&D(t,!0)},q=function(e,t){M||(y(t),K(e))},V=function(){M||y(null)},K=function(e){if(G.current){var t=G.current.getBoundingClientRect();R({x:e.clientX-t.left+20,y:e.clientY-t.top})}},Q=function(e){if(e instanceof MouseEvent&&"mousemove"===e.type){if(b&&G.current){var t=e,a=G.current.getBoundingClientRect();R({x:t.clientX-a.left+20,y:t.clientY-a.top})}}else K(e);if(M&&S&&G.current)try{var n=e.clientX-A;if(0===n)return;var r=i*s,o=document.querySelector('[data-task-id="'.concat(M.id,'"][data-instance-id="').concat(_.current,'"]'));if(!o)return;var l=parseFloat(o.style.left||"0"),c=parseFloat(o.style.width||"0"),d=l,u=c;if("move"===S)d=Math.max(0,Math.min(r-c,l+n)),o.style.left="".concat(d,"px");else if("resize-left"===S){var f=c-20,g=Math.min(f,n);d=Math.max(0,l+g),u=Math.max(20,c-g),o.style.left="".concat(d,"px"),o.style.width="".concat(u,"px")}else"resize-right"===S&&(u=Math.max(20,Math.min(r-l,c+n)),o.style.width="".concat(u,"px"));var h=m.calculateDatesFromPosition(d,u,k,x,i,s),v=h.newStartDate,p=h.newEndDate,D=m.createUpdatedTask(M,v,p);z(D),W(D),I(e.clientX)}catch(e){console.error("Error in handleMouseMove:",e)}},J=function(e,t,a){c&&(e.preventDefault(),e.stopPropagation(),T(t),F(a),I(e.clientX),z(t),function(e){T(e),U.current=e}(t),W(t),document.addEventListener("mouseup",Z),document.addEventListener("mousemove",Q))},Z=function(){try{var e=U.current,t=H.current;e&&t&&v&&v(a.id,t)}catch(e){console.error("Error in handleMouseUp:",e)}finally{T(null),F(null),z(null),U.current=null,H.current=null,document.removeEventListener("mouseup",Z),document.removeEventListener("mousemove",Q)}};return e.useEffect((function(){!M&&O&&v&&v(a.id,O)}),[M,O,a.id,v]),e.useEffect((function(){return function(){document.removeEventListener("mouseup",Z),document.removeEventListener("mousemove",Q)}}),[]),a.tasks&&0!==a.tasks.length?r.default.createElement("div",{className:"relative border-b border-gantt-border",style:{height:"".concat(B,"px")},onMouseMove:function(e){return Q(e)},onMouseLeave:function(){return y(null)},ref:G,"data-testid":"task-row-".concat(a.id),"data-instance-id":_.current},j.map((function(e,t){return r.default.createElement(r.default.Fragment,{key:"task-row-".concat(t)},e.map((function(e){try{if(!(e&&e.id&&e.startDate instanceof Date&&e.endDate instanceof Date))return console.warn("Invalid task data:",e),null;var a=m.calculateTaskPixelPosition(e,k,x,i,s),n=a.leftPx,o=a.widthPx,l=(null==b?void 0:b.id)===e.id,d=(null==M?void 0:M.id)===e.id,f=40*t+10;return r.default.createElement(g,{key:"task-".concat(e.id),task:e,leftPx:n,widthPx:o,topPx:f,isHovered:l,isDragging:d,editMode:c,showProgress:u,instanceId:_.current,onMouseDown:J,onMouseEnter:q,onMouseLeave:V,onClick:X})}catch(t){return console.error("Error rendering task:",t,e),null}})))})),(b||M)&&r.default.createElement(h,{task:O||M||b,position:C,dragType:S,taskId:null==M?void 0:M.id,startDate:k,endDate:x,totalMonths:i,monthWidth:s,showProgress:u,instanceId:_.current})):r.default.createElement("div",{className:"relative h-16 text-gantt-text"},"No tasks available")},p=function(e){var t=e.months,a=e.currentMonthIndex,n=e.showWeeks,o=void 0!==n&&n,i=e.showDays,s=void 0!==i&&i,l=e.locale,c=void 0===l?"default":l,d=e.className,u=void 0===d?"":d,f=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()};return r.default.createElement("div",{className:"rmg-timeline ".concat(u)},r.default.createElement("div",{className:"flex border-b border-gantt-border"},t.map((function(e,t){return r.default.createElement("div",{key:"month-".concat(t),className:"w-[var(--gantt-month-width)] flex-shrink-0 p-2 font-semibold text-center text-gantt-text ".concat(t===a?"bg-gantt-highlight":""),"data-month":e.toISOString()},(n=e)instanceof Date?n.toLocaleString(c,{month:"short",year:"2-digit"}):"");var n}))),o&&r.default.createElement("div",{className:"flex border-b border-gantt-border"},t.map((function(e,t){var a=[1,8,15,22,29],n=f(e),o=150/n;return r.default.createElement("div",{key:"week-".concat(t),className:"relative w-[var(--gantt-month-width)] flex-shrink-0 h-6"},a.filter((function(e){return e<=n})).map((function(e){return r.default.createElement("div",{key:"week-".concat(t,"-").concat(e),className:"absolute top-0 bottom-0 border-l border-gantt-border",style:{left:"".concat(e*o,"px")}},r.default.createElement("span",{className:"absolute -top-1 left-1 text-xs text-gantt-text"},function(e){return e.toString()}(e)))})))}))),s&&r.default.createElement("div",{className:"flex border-b border-gantt-border"},t.map((function(e,t){var a=f(e);return r.default.createElement("div",{key:"days-".concat(t),className:"flex w-[var(--gantt-month-width)] flex-shrink-0 h-5"},Array.from({length:a}).map((function(e,n){return r.default.createElement("div",{key:"day-".concat(t,"-").concat(n),className:"border-r border-gantt-border",style:{width:"".concat(100/a,"%")}},n%5==0&&r.default.createElement("span",{className:"text-xs text-gantt-text opacity-70"},n+1))})))}))))},D=function(e){var t=e.currentMonthIndex,a=e.height,n=e.label,o=void 0===n?"Today":n,i=e.dayOfMonth,s=e.className,l=void 0===s?"":s;if(t<0)return null;var c=new Date,d=new Date(c.getFullYear(),c.getMonth()+1,0).getDate(),u=150*(t+(i?(i-1)/d:.5));return r.default.createElement("div",{className:"rmg-today-marker absolute top-0 w-px bg-gantt-marker z-10 ".concat(l),style:{left:"".concat(u,"px"),height:"".concat(a,"px")},"data-testid":"today-marker"},r.default.createElement("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 bg-gantt-marker px-1 py-0.5 rounded text-xs text-white dark:text-gray-100 whitespace-nowrap",style:{top:"-10px"}},o))},k=function(e){var t=e.tasks,a=void 0===t?[]:t,n=e.headerLabel,o=void 0===n?"Resources":n,i=e.showIcon,s=void 0!==i&&i,l=e.showTaskCount,d=void 0!==l&&l,u=e.showDescription,f=void 0===u||u,m=e.rowHeight,g=void 0===m?40:m,h=e.className,v=void 0===h?"":h,p=e.onGroupClick,D=Array.isArray(a)?a:[];return r.default.createElement("div",{className:"rmg-task-list w-40 flex-shrink-0 z-10 bg-gantt-bg shadow-sm ".concat(v)},r.default.createElement("div",{className:"p-2 font-semibold text-gantt-text border-r border-b border-gantt-border h-10.5"},o),D.map((function(e){if(!e)return null;var t=function(e){if(!e.tasks||!Array.isArray(e.tasks))return 60;var t=c(e.tasks);return Math.max(60,t.length*g+20)}(e);return r.default.createElement("div",{key:"task-group-".concat(e.id||"unknown"),className:"p-2 border-r border-b border-gantt-border font-medium text-gantt-text bg-gantt-bg hover:bg-gantt-highlight transition-colors duration-150",style:{height:"".concat(t,"px")},onClick:function(){return t=e,void(p&&p(t));var t},"data-testid":"task-group-".concat(e.id||"unknown")},r.default.createElement("div",{className:"flex items-center"},s&&e.icon&&r.default.createElement("span",{className:"mr-2",dangerouslySetInnerHTML:{__html:e.icon}}),r.default.createElement("div",{className:"font-medium truncate"},e.name||"Unnamed")),f&&e.description&&r.default.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 truncate"},e.description),d&&e.tasks&&e.tasks.length>0&&r.default.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},e.tasks.length," ",1===e.tasks.length?"task":"tasks"))})))},x=function(e){var t=e.children,a=void 0===t?"Project Timeline":t,n=e.className,o=void 0===n?"":n;return r.default.createElement("h1",{className:"rmg-gantt-title text-2xl font-bold text-gantt-text ".concat(o)},a)},w=function(e){var t=e.children,a=void 0===t?"Resources":t,n=e.className,o=void 0===n?"":n;return r.default.createElement("div",{className:"rmg-gantt-header font-semibold text-gantt-text ".concat(o)},a)},b=function(e){var t=e.children,a=void 0===t?"Today":t,n=e.className,o=void 0===n?"":n,i=e.markerClassName,s=void 0===i?"bg-gantt-marker":i;return r.default.createElement("div",{className:"rmg-gantt-marker px-1 py-0.5 rounded text-xs text-white dark:text-gray-100 whitespace-nowrap ".concat(s," ").concat(o)},a)},y=function(e){e.tasks;var t=e.headerLabel,a=void 0===t?"Resources":t;e.showIcon,e.showTaskCount,e.showDescription;var n=e.className,o=void 0===n?"":n,i=e.children;return e.onGroupClick,r.default.createElement("div",{className:"rmg-gantt-task-list w-40 flex-shrink-0 z-10 bg-gantt-bg shadow-sm ".concat(o)},i||r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"p-2 font-semibold text-gantt-text border-r border-b border-gantt-border h-10.5"},a)))},E=function(e){var t=e.months,a=void 0===t?[]:t,n=e.currentMonthIndex,o=void 0===n?-1:n;e.showWeeks,e.showDays;var i=e.locale,s=void 0===i?"default":i,l=e.className,c=void 0===l?"":l,d=e.children;return r.default.createElement("div",{className:"rmg-gantt-timeline flex border-b border-gantt-border ".concat(c)},d||r.default.createElement(r.default.Fragment,null,a.map((function(e,t){var a;return r.default.createElement("div",{key:t,className:"w-[var(--gantt-month-width)] flex-shrink-0 p-2 font-semibold text-center text-gantt-text ".concat(t===o?"bg-gantt-highlight":"")},(a=e)instanceof Date?a.toLocaleString(s,{month:"short",year:"2-digit"}):"")}))))},M=function(e){var t=e.task,a=e.group,n=e.leftPx,o=void 0===n?0:n,i=e.widthPx,s=void 0===i?100:i,l=e.topPx,c=void 0===l?0:l,d=e.isSelected,u=void 0!==d&&d,f=e.editMode,m=void 0===f||f,g=e.showProgress,h=void 0!==g&&g,v=e.className,p=void 0===v?"":v,D=e.onSelect,k=e.onClick,x=e.onDoubleClick;if(e.onDragStart,e.onDragEnd,!t||!t.id)return console.warn("GanttTaskItem: Invalid task data",t),null;var w=t.color||"bg-gantt-task";return r.default.createElement("div",{className:"rmg-gantt-task-item absolute h-8 rounded ".concat(w," flex items-center px-2 text-xs text-gantt-task-text font-medium ").concat(m?"cursor-move":"cursor-pointer"," ").concat(u?"ring-2 ring-white dark:ring-gray-300":""," ").concat(p),style:{left:"".concat(Math.max(0,o),"px"),width:"".concat(Math.max(20,s),"px"),top:"".concat(c,"px")},onClick:function(e){k&&k(t,a),D&&D(t,!u)},onDoubleClick:function(e){x&&x(t)},"data-task-id":t.id},m&&r.default.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 dark:bg-opacity-40 cursor-ew-resize rounded-l"}),r.default.createElement("div",{className:"truncate select-none"},t.name||"Unnamed Task"),h&&"number"==typeof t.percent&&r.default.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 dark:bg-opacity-30 rounded-full overflow-hidden"},r.default.createElement("div",{className:"h-full bg-white dark:bg-gray-200 rounded-full",style:{width:"".concat(t.percent,"%")}})),m&&r.default.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 dark:bg-opacity-40 cursor-ew-resize rounded-r"}))};exports.CollisionManager=f,exports.GanttChart=function(t){var a=t.tasks,n=void 0===a?[]:a,s=t.startDate,f=t.endDate,m=t.title,g=void 0===m?"Project Timeline":m,h=t.currentDate,T=void 0===h?new Date:h,N=t.showCurrentDateMarker,S=void 0===N||N,F=t.todayLabel,P=void 0===F?"Today":F,A=t.editMode,I=void 0===A||A,L=t.headerLabel,C=void 0===L?"Resources":L,R=t.showProgress,Y=void 0!==R&&R;t.theme;var O=t.darkMode,z=void 0!==O&&O,G=t.showWeeks,U=void 0!==G&&G,H=t.showDays,_=void 0!==H&&H,W=t.locale,j=void 0===W?"default":W,B=t.onTaskUpdate,X=t.onTaskClick,q=t.onTaskSelect,V=t.onTaskDoubleClick,K=t.onGroupClick,Q=t.fontSize,J=t.rowHeight,Z=void 0===J?40:J;t.timeStep;var $=t.children,ee=e.useRef(null),te=e.useRef(null),ae=e.useState([]),ne=ae[0],re=ae[1],oe=s||d(n),ie=f||u(n),se=l(oe,ie),le=se.length,ce=T.getMonth(),de=T.getFullYear(),ue=T.getDate(),fe=se.findIndex((function(e){return e.getMonth()===ce&&e.getFullYear()===de})),me={title:x,header:w,marker:b,taskList:y,timeline:E,taskItem:M},ge=function(t){return e.Children.toArray($).filter((function(a){return e.isValidElement(a)&&a.type===me[t]}))},he=ge("title");ge("header");var ve,pe=ge("marker"),De=ge("taskList"),ke=ge("timeline"),xe=ge("taskItem"),we=function(e,t){if(B)try{var a=o(o({},t),{startDate:t.startDate instanceof Date?t.startDate:new Date(t.startDate),endDate:t.endDate instanceof Date?t.endDate:new Date(t.endDate)});B(e,a)}catch(e){console.error("Error in handleTaskUpdate:",e)}},be=function(e,t){if(X)try{X(e,t)}catch(e){console.error("Error in handleTaskClick:",e)}},ye=function(e,t){if(re((function(a){return t?i(i([],a,!0),[e.id],!1):a.filter((function(t){return t!==e.id}))})),q)try{q(e,t)}catch(e){console.error("Error in onTaskSelect handler:",e)}},Ee=function(e){if(V)try{V(e)}catch(e){console.error("Error in onTaskDoubleClick handler:",e)}},Me=function(e){if(K)try{K(e)}catch(e){console.error("Error in onGroupClick handler:",e)}},Te={fontSize:Q||"inherit"},Ne=z?"dark":"";return r.default.createElement("div",{ref:ee,className:"rmg-gantt-chart w-full bg-gantt-bg text-gantt-text rounded-xl shadow-lg overflow-hidden ".concat(Ne),style:Te,"data-testid":"gantt-chart"},r.default.createElement("div",{className:"p-6 border-b border-gantt-border"},he.length>0?e.cloneElement(he[0]):r.default.createElement(x,null,g)),r.default.createElement("div",{className:"relative flex"},De.length>0?e.cloneElement(De[0],{tasks:n,headerLabel:C,onGroupClick:Me}):r.default.createElement(k,{tasks:n,headerLabel:C,onGroupClick:Me}),r.default.createElement("div",{ref:te,className:"flex-grow overflow-x-auto"},r.default.createElement("div",{className:"min-w-max"},ke.length>0?e.cloneElement(ke[0],{months:se,currentMonthIndex:fe,showWeeks:U,showDays:_,locale:j}):r.default.createElement(p,{months:se,currentMonthIndex:fe,showWeeks:U,showDays:_,locale:j}),r.default.createElement("div",{className:"relative"},S&&fe>=0&&(pe.length>0?e.cloneElement(pe[0],{children:P}):r.default.createElement(D,{currentMonthIndex:fe,height:(ve=0,n.forEach((function(e){if(e&&Array.isArray(e.tasks)){var t=c(e.tasks);ve+=Math.max(60,t.length*Z+20)}else ve+=60})),ve),label:P,dayOfMonth:ue})),xe.length>0?r.default.createElement("div",{className:"relative"},xe.map((function(t,a){var n=t.props.task,r=null==n?void 0:n.id;return e.cloneElement(t,{key:"custom-task-item-".concat(a),isSelected:!!r&&ne.includes(r),onSelect:ye,onClick:be,onDoubleClick:Ee})}))):n.map((function(e){return e&&e.id?r.default.createElement(v,{key:"task-row-".concat(e.id),taskGroup:e,startDate:oe,endDate:ie,totalMonths:le,monthWidth:150,editMode:I,showProgress:Y,onTaskUpdate:we,onTaskClick:be,onTaskSelect:ye}):null})))))))},exports.GanttHeader=w,exports.GanttMarker=b,exports.GanttTaskItem=M,exports.GanttTaskList=y,exports.GanttTimeline=E,exports.GanttTitle=x,exports.TaskItem=g,exports.TaskList=k,exports.TaskManager=m,exports.TaskRow=v,exports.Timeline=p,exports.TodayMarker=D,exports.Tooltip=h,exports.calculateDuration=function(e,t){var a;if(!(e instanceof Date&&t instanceof Date))return 0;e>t&&(e=(a=[t,e])[0],t=a[1]);var n=Math.abs(t.getTime()-e.getTime());return Math.ceil(n/864e5)},exports.calculateTaskPosition=function(e,t,a){if(!(e.startDate instanceof Date&&e.endDate instanceof Date))return console.warn("calculateTaskPosition: Invalid task dates",e),{left:"0%",width:"10%"};var n=l(new Date(t.getFullYear(),t.getMonth(),1),new Date(a.getFullYear(),a.getMonth()+1,0)),r=n.length,o=e.startDate.getFullYear(),i=e.startDate.getMonth(),s=n.findIndex((function(e){return e.getFullYear()===o&&e.getMonth()===i})),c=s<0?0:s,d=e.endDate.getFullYear(),u=e.endDate.getMonth(),f=n.findIndex((function(e){return e.getFullYear()===d&&e.getMonth()===u})),m=((f<0?n.length-1:f)-c+1)/r*100;return{left:"".concat(c/r*100,"%"),width:"".concat(m,"%")}},exports.darkTheme={background:"#1f2937",text:"#f3f4f6",border:"#374151",highlight:"#374151",marker:"#ef4444",task:"#4f46e5",taskText:"#ffffff",tooltip:"#1f2937",tooltipText:"#f3f4f6",tooltipBorder:"#374151",progress:"rgba(0, 0, 0, 0.3)",progressFill:"#e5e7eb"},exports.detectTaskOverlaps=c,exports.findEarliestDate=d,exports.findLatestDate=u,exports.formatDate=s,exports.formatDateRange=function(e,t,a){if(void 0===a&&(a="default"),!(e instanceof Date&&t instanceof Date))return"Invalid date range";var n=s(e,exports.DateDisplayFormat.SHORT_DATE,a),r=s(t,exports.DateDisplayFormat.SHORT_DATE,a);return"".concat(n," - ").concat(r)},exports.formatMonth=function(e,t){return void 0===t&&(t="default"),e.toLocaleString(t,{month:"short"})},exports.getDaysInMonth=function(e,t){return new Date(e,t+1,0).getDate()},exports.getMonthsBetween=l,exports.getStandardDayMarkers=function(){return[1,8,15,22,29]},exports.lightTheme={background:"#ffffff",text:"#1f2937",border:"#e5e7eb",highlight:"#eff6ff",marker:"#ef4444",task:"#3b82f6",taskText:"#ffffff",tooltip:"#ffffff",tooltipText:"#1f2937",tooltipBorder:"#e5e7eb",progress:"rgba(0, 0, 0, 0.2)",progressFill:"#ffffff"},exports.mergeTheme=function(e,t){return t?o(o({},e),t):e};
//# sourceMappingURL=index.js.map
