"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a,n=t(e),r=function(){return r=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,exports.DateDisplayFormat=void 0,(a=exports.DateDisplayFormat||(exports.DateDisplayFormat={})).MONTH_YEAR="month-year",a.FULL_DATE="full-date",a.SHORT_DATE="short-date";var o={headerBackground:"bg-white",headerText:"text-gray-700",backgroundHighlight:"bg-blue-50",borderColor:"border-gray-200",todayMarkerColor:"bg-red-500"};function l(e,t){for(var a=[],n=e.getFullYear(),r=e.getMonth(),o=t.getFullYear(),l=t.getMonth(),i=n;i<=o;i++)for(var s=i===o?l:11,c=i===n?r:0;c<=s;c++)a.push(new Date(i,c,1));return a}function i(e,t,a){var n=l(new Date(t.getFullYear(),t.getMonth(),1),new Date(a.getFullYear(),a.getMonth()+1,0)),r=n.length,o=e.startDate.getFullYear(),i=e.startDate.getMonth(),s=n.findIndex((function(e){return e.getFullYear()===o&&e.getMonth()===i})),c=s<0?0:s,d=e.endDate.getFullYear(),u=e.endDate.getMonth(),f=n.findIndex((function(e){return e.getFullYear()===d&&e.getMonth()===u})),m=((f<0?n.length-1:f)-c+1)/r*100;return{left:"".concat(c/r*100,"%"),width:"".concat(m,"%")}}function s(e){var t=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a=[];return t.forEach((function(e){for(var t=!1,n=0;n<a.length;n++){if(!a[n].some((function(t){return!(e.startDate>=t.endDate||e.endDate<=t.startDate)}))){a[n].push(e),t=!0;break}}t||a.push([e])})),a}function c(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.startDate<t&&(t=new Date(e.startDate))}))})),new Date(t.getFullYear(),t.getMonth(),1)}function d(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.endDate>t&&(t=new Date(e.endDate))}))})),new Date(t.getFullYear(),t.getMonth()+1,0)}var u=function(t){var a,o,l=t.person,c=t.startDate,d=t.endDate,u=t.totalMonths,f=t.monthWidth,m=t.editMode,h=void 0===m||m,p=t.onTaskUpdate,g=t.onTaskClick,v=e.useState(null),x=v[0],y=v[1],D=e.useState(null),b=D[0],E=D[1],w=e.useState(null),M=w[0],k=w[1],T=e.useState(0),N=T[0],F=T[1],S=e.useState({x:0,y:0}),L=S[0],Y=S[1],C=e.useRef(null),R=s(l.tasks),A=Math.max(60,40*R.length+20),O=function(){b||y(null)},_=function(e){if(C.current){var t=C.current.getBoundingClientRect();Y({x:e.clientX-t.left+20,y:e.clientY-t.top})}},z=function(e){var t,a;if(e instanceof MouseEvent&&"mousemove"===e.type){if(x){var n=e;Y({x:n.clientX-((null===(t=C.current)||void 0===t?void 0:t.getBoundingClientRect().left)||0)+20,y:n.clientY-((null===(a=C.current)||void 0===a?void 0:a.getBoundingClientRect().top)||0)})}}else _(e);if(b&&M&&C.current){C.current.getBoundingClientRect();var r=u*f,o=e.clientX-N,l=document.querySelector('[data-task-id="'.concat(b.id,'"]'));if(!l)return;var i=parseFloat(l.style.left),s=parseFloat(l.style.width);if("move"===M){var c=Math.max(0,Math.min(r-s,i+o));l.style.left="".concat(c,"px")}else if("resize-left"===M){var d=s-20,m=Math.min(d,o),h=(c=Math.max(0,i+m),Math.max(20,s-m));l.style.left="".concat(c,"px"),l.style.width="".concat(h,"px")}else if("resize-right"===M){h=Math.max(20,Math.min(r-i,s+o));l.style.width="".concat(h,"px")}F(e.clientX)}},P=function(e,t,a){h&&(e.preventDefault(),e.stopPropagation(),E(t),k(a),F(e.clientX),document.addEventListener("mouseup",U),document.addEventListener("mousemove",z))},U=function(){if(b&&M&&C.current){var e=document.querySelector('[data-task-id="'.concat(b.id,'"]'));if(e){var t=parseFloat(e.style.left),a=parseFloat(e.style.width),n=(d.getTime()-c.getTime())/(u*f),o=t*n,i=a*n,s=new Date(c.getTime()+o),m=new Date(s.getTime()+i),h=r(r({},b),{startDate:s,endDate:m});p&&p(l.id,h)}}E(null),k(null),document.removeEventListener("mouseup",U),document.removeEventListener("mousemove",z)};e.useEffect((function(){return function(){document.removeEventListener("mouseup",U),document.removeEventListener("mousemove",z)}}),[]);var B=function(e){return e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},H=function(e,t){var a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)},j=function(e,t){var a=document.querySelector('[data-task-id="'.concat(e,'"]'));if(!a)return"start"===t?c:d;var n=parseFloat(a.style.left||"0"),r=parseFloat(a.style.width||"0"),o=(d.getTime()-c.getTime())/(u*f);if("start"===t){var l=n*o;return new Date(c.getTime()+l)}var i=(n+r)*o;return new Date(c.getTime()+i)};return l.tasks&&0!==l.tasks.length?n.default.createElement("div",{className:"relative border-b border-gray-200",style:{height:"".concat(A,"px")},onMouseMove:function(e){return z(e)},onMouseLeave:function(){return y(null)},ref:C,"data-testid":"task-row-".concat(l.id)},R.map((function(e,t){return n.default.createElement(n.default.Fragment,{key:"task-row-".concat(t)},e.map((function(e){var a=i(e,c,d),r=a.left,o=a.width,s=parseFloat(r)*u*f/100,m=parseFloat(o)*u*f/100,p=(null==x?void 0:x.id)===e.id,v=(null==b?void 0:b.id)===e.id,D=(p||v)&&h;return n.default.createElement("div",{key:"task-".concat(e.id),className:"absolute h-8 rounded ".concat(e.color," flex items-center px-2 text-xs text-white font-medium ").concat(h?"cursor-move":"cursor-pointer"),style:{left:"".concat(s,"px"),width:"".concat(m,"px"),top:"".concat(40*t+10,"px")},onClick:function(t){return function(e,t){g&&!b&&g(t,l)}(0,e)},onMouseDown:function(t){return P(t,e,"move")},onMouseEnter:function(t){return function(e,t){b||(y(t),_(e))}(t,e)},onMouseLeave:O,"data-testid":"task-".concat(e.id),"data-task-id":e.id},D&&n.default.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 cursor-ew-resize rounded-l",onMouseDown:function(t){t.stopPropagation(),P(t,e,"resize-left")}}),n.default.createElement("div",{className:"truncate select-none"},e.name),void 0!==e.percent&&n.default.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 rounded-full overflow-hidden"},n.default.createElement("div",{className:"h-full bg-white rounded-full",style:{width:"".concat(e.percent,"%")}})),D&&n.default.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 cursor-ew-resize rounded-r",onMouseDown:function(t){t.stopPropagation(),P(t,e,"resize-right")}}))})))})),(x||b)&&n.default.createElement("div",{className:"absolute z-20 bg-white border border-gray-200 rounded-md shadow-md p-2 text-xs select-none",style:{left:"".concat(L.x,"px"),top:"".concat(L.y-40,"px"),minWidth:"150px"}},n.default.createElement("div",{className:"font-bold mb-1"},null===(a=b||x)||void 0===a?void 0:a.name),n.default.createElement("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1"},n.default.createElement("div",{className:"font-semibold"},"Start:"),n.default.createElement("div",null,B(M&&b?j(b.id,"start"):(b||x).startDate)),n.default.createElement("div",{className:"font-semibold"},"End:"),n.default.createElement("div",null,B(M&&b?j(b.id,"end"):(b||x).endDate)),n.default.createElement("div",{className:"font-semibold"},"Duration:"),n.default.createElement("div",null,M&&b?H(j(b.id,"start"),j(b.id,"end")):H((b||x).startDate,(b||x).endDate)," ","days"),void 0!==(null===(o=b||x)||void 0===o?void 0:o.percent)&&n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"font-semibold"},"Progress:"),n.default.createElement("div",null,(b||x).percent,"%"))))):n.default.createElement("div",{className:"relative h-16"},"No tasks available")};exports.DEFAULT_THEME=o,exports.GanttChart=function(t){var a=t.people,r=t.startDate,i=t.endDate,f=t.title,m=void 0===f?"Project Timeline":f,h=t.currentDate,p=void 0===h?new Date:h,g=t.showCurrentDateMarker,v=void 0===g||g,x=t.editMode,y=void 0===x||x,D=t.theme,b=void 0===D?o:D,E=t.onTaskUpdate,w=t.onTaskClick,M=e.useRef(null),k=e.useRef(null),T=r||c(a),N=i||d(a),F=l(T,N),S=F.length,L=p.getMonth(),Y=p.getFullYear(),C=F.findIndex((function(e){return e.getMonth()===L&&e.getFullYear()===Y}));b.headerBackground,b.headerText,b.borderColor;var R,A=b.backgroundHighlight||"bg-blue-50",O=b.todayMarkerColor||"bg-red-500",_=function(e,t){E&&E(e,t)};return n.default.createElement("div",{ref:M,className:"w-full bg-white rounded-xl shadow-lg overflow-hidden","data-testid":"gantt-chart"},n.default.createElement("div",{className:"p-6 border-b border-gray-200"},n.default.createElement("h1",{className:"text-2xl font-bold text-gray-800"},m)),n.default.createElement("div",{className:"relative flex"},n.default.createElement("div",{className:"w-40 flex-shrink-0 z-10 bg-white shadow-sm"},n.default.createElement("div",{className:"p-2 font-semibold text-gray-700 border-r border-b border-gray-200 h-10.5"},"Team Member"),a.map((function(e){var t=s(e.tasks),a=Math.max(60,40*t.length+20);return n.default.createElement("div",{key:"person-".concat(e.id),className:"p-2 border-r border-b border-gray-200 font-medium",style:{height:"".concat(a,"px")},"data-testid":"person-label-".concat(e.id)},n.default.createElement("div",{className:"font-medium"},e.name),e.role&&n.default.createElement("div",{className:"text-xs text-gray-500"},e.role))}))),n.default.createElement("div",{ref:k,className:"flex-grow overflow-x-auto"},n.default.createElement("div",{className:"min-w-max"},n.default.createElement("div",{className:"flex border-b border-gray-200"},F.map((function(e,t){return n.default.createElement("div",{key:t,className:"w-[150px] flex-shrink-0 p-2 font-semibold text-center ".concat(t===C?A:""),"data-month":e.toISOString()},e.toLocaleString("default",{month:"short",year:"2-digit"}))}))),n.default.createElement("div",{className:"relative"},v&&C>=0&&n.default.createElement("div",{className:"absolute top-0 w-px ".concat(O," z-10"),style:{left:"".concat(150*(C+.5),"px"),height:"".concat((R=0,a.forEach((function(e){var t=s(e.tasks);R+=Math.max(60,40*t.length+20)})),R),"px")},"data-testid":"today-marker"},n.default.createElement("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 ".concat(O," px-1 py-0.5 rounded text-xs text-white whitespace-nowrap")},"Today")),a.map((function(e){return n.default.createElement(u,{key:"task-row-".concat(e.id),person:e,startDate:T,endDate:N,totalMonths:S,monthWidth:150,editMode:y,onTaskUpdate:_,onTaskClick:w})})))))))},exports.TaskRow=u,exports.calculateTaskPosition=i,exports.detectTaskOverlaps=s,exports.findEarliestDate=c,exports.findLatestDate=d,exports.formatDate=function(e,t){switch(void 0===t&&(t=exports.DateDisplayFormat.FULL_DATE),t){case exports.DateDisplayFormat.MONTH_YEAR:return e.toLocaleString("default",{month:"short",year:"2-digit"});case exports.DateDisplayFormat.SHORT_DATE:return e.toLocaleString("default",{month:"short",day:"numeric"});case exports.DateDisplayFormat.FULL_DATE:default:return e.toLocaleString("default",{month:"short",day:"numeric",year:"numeric"})}},exports.formatMonth=function(e){return e.toLocaleString("default",{month:"short"})},exports.getDaysInMonth=function(e,t){return new Date(e,t+1,0).getDate()},exports.getMonthsBetween=l,exports.getStandardDayMarkers=function(){return[1,8,15,22,29]};
//# sourceMappingURL=index.js.map
