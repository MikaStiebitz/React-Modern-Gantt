"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a,n=t(e),r=function(){return r=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,exports.DateDisplayFormat=void 0,(a=exports.DateDisplayFormat||(exports.DateDisplayFormat={})).MONTH_YEAR="MONTH_YEAR",a.WEEK_DAY="WEEK_DAY",a.DAY_MONTH="DAY_MONTH",a.FULL_DATE="FULL_DATE";var o={headerBackground:"bg-gray-50",headerText:"text-gray-700",timelineBackground:"bg-gray-50",timelineBorder:"border-gray-200",timelineText:"text-gray-500",taskDefaultColor:"bg-blue-500",highlightColor:"bg-indigo-100",todayMarkerColor:"bg-red-500",tooltipBackground:"bg-white",tooltipText:"text-gray-700"};function l(e,t){switch(void 0===t&&(t=exports.DateDisplayFormat.MONTH_YEAR),t){case exports.DateDisplayFormat.MONTH_YEAR:return e.toLocaleString("default",{month:"short",year:"numeric"}).toUpperCase();case exports.DateDisplayFormat.WEEK_DAY:return e.toLocaleString("default",{weekday:"short",day:"numeric"});case exports.DateDisplayFormat.DAY_MONTH:return e.toLocaleString("default",{day:"numeric",month:"short"});case exports.DateDisplayFormat.FULL_DATE:return e.toLocaleDateString("default",{year:"numeric",month:"short",day:"numeric"});default:return e.toLocaleString("default",{month:"short",year:"numeric"})}}function s(e,t){return new Date(e,t+1,0).getDate()}function i(e,t){var a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)}function c(e,t,a,n){var r=new Date(t);r.setHours(0,0,0,0);var o=new Date(a);o.setHours(23,59,59,999);var l=new Date(e.startDate);l.setHours(0,0,0,0);var s=new Date(e.endDate);s.setHours(23,59,59,999);var c=i(r,o),u=Math.max(0,i(r,l)),d=Math.min(c,i(r,s)),m=Math.max(1,d-u),f=c/function(e,t){return 12*(t.getFullYear()-e.getFullYear())+t.getMonth()-e.getMonth()+1}(r,o),v=n/f,p=m*v,h=s<r||l>o;return{left:"".concat(u*v,"px"),width:"".concat(p,"px"),isOutOfRange:h}}function u(e){var t=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a=[];return t.forEach((function(e){for(var t=!1,n=0;n<a.length;n++){var r=a[n][a[n].length-1];if(e.startDate>=r.endDate){a[n].push(e),t=!0;break}}t||a.push([e])})),a}function d(e,t){for(var a=[],n=new Date(e);n<=t;)a.push(l(n,exports.DateDisplayFormat.MONTH_YEAR)),n.setMonth(n.getMonth()+1);return a}function m(e,t){void 0===t&&(t=1);var a=new Date(e),n=a.getDate(),r=Math.round(n/t)*t;return a.setDate(r),a}var f=function(e){var t=e.people,a=e.showAvatar,r=void 0===a||a,o=e.showTaskCount,l=void 0===o||o,s=e.theme,i=(null==s?void 0:s.headerBackground)||"bg-gray-50",c=(null==s?void 0:s.headerText)||"text-gray-700",d=(null==s?void 0:s.timelineBorder)||"border-gray-200";return n.default.createElement("div",{className:"name-list w-64 flex-shrink-0 bg-white border-r border-gray-200 z-10"},n.default.createElement("div",{className:"h-24 border-b ".concat(d," ").concat(i," flex items-center justify-center")},n.default.createElement("span",{className:"font-semibold ".concat(c)},"Team Members")),n.default.createElement("div",{className:"people-list"},t.map((function(e,a){var o=u(e.tasks),s=Math.max(60,40*o.length),i=e.name.charAt(0).toUpperCase();return n.default.createElement("div",{key:e.id,className:"flex items-center px-4 ".concat(a!==t.length-1?"border-b ".concat(d):""),style:{height:"".concat(s,"px")}},r&&(e.avatar?n.default.createElement("img",{src:e.avatar,alt:e.name,className:"w-8 h-8 rounded-full mr-3"}):n.default.createElement("div",{className:"w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-white text-sm mr-3"},i)),n.default.createElement("div",{className:"flex flex-col"},n.default.createElement("div",{className:"font-medium text-sm"},e.name),e.role&&n.default.createElement("div",{className:"text-xs text-gray-500"},e.role),l&&n.default.createElement("div",{className:"text-xs text-gray-500 mt-1"},e.tasks.length," ",1===e.tasks.length?"task":"tasks")))}))))},v=function(e){for(var t=e.startDate,a=e.endDate,r=e.columnWidth,o=e.theme,i=e.children,c=e.scrollContainerRef,u=[],d=new Date(t);d<=a;)u.push({date:new Date(d),daysInMonth:s(d.getFullYear(),d.getMonth())}),d.setMonth(d.getMonth()+1);var m=(null==o?void 0:o.headerBackground)||"bg-gray-50",f=(null==o?void 0:o.headerText)||"text-gray-700",v=(null==o?void 0:o.timelineBorder)||"border-gray-200",p=(null==o?void 0:o.timelineText)||"text-gray-500";return n.default.createElement("div",{className:"timeline flex-grow overflow-x-auto overflow-y-hidden",ref:c},n.default.createElement("div",{className:"inline-block min-w-full"},n.default.createElement("div",{className:"grid border-b",style:{gridTemplateColumns:"repeat(".concat(u.length,", ").concat(r,"px)")}},u.map((function(e,t){return n.default.createElement("div",{key:"month-".concat(t),className:"border-r ".concat(v)},n.default.createElement("div",{className:"flex h-12 items-center justify-center ".concat(m)},n.default.createElement("p",{className:"font-semibold ".concat(f)},l(e.date,exports.DateDisplayFormat.MONTH_YEAR))),n.default.createElement("div",{className:"flex h-12 items-center justify-between px-2 text-xs ".concat(p," ").concat(m)},[1,8,15,22,29].map((function(t){var a=t<=e.daysInMonth?t:e.daysInMonth;return n.default.createElement("div",{key:"day-".concat(e.date.getMonth(),"-").concat(t),className:"relative",style:{width:"20px",textAlign:"center"}},n.default.createElement("span",null,a),n.default.createElement("div",{className:"absolute top-full h-screen w-px bg-gray-200 -z-10",style:{left:"50%",transform:"translateX(-50%)"}}))}))))}))),n.default.createElement("div",{className:"relative task-container"},i)))},p=function(t){var a=t.person,o=t.startDate,s=t.endDate,d=t.columnWidth,f=t.theme,v=t.onTaskUpdate,p=t.onTaskClick,h=t.onProgressChange,g=e.useState(null),D=g[0],x=g[1],E=e.useState(null),w=E[0],y=E[1],b=e.useState(0),N=b[0],M=b[1],T=e.useState(0),k=T[0],C=T[1],L=e.useState(null),A=L[0],F=L[1],_=e.useState({x:0,y:0}),Y=_[0],O=_[1],S=e.useState(!1),H=S[0],R=S[1],z=e.useRef(null),P=function(e){return c(e,o,s,d)},B=function(e){return l(e,exports.DateDisplayFormat.FULL_DATE)},j=function(e,t,a){e.preventDefault(),x(t),y(a),M(e.clientX),C(e.clientY),R(!1),I(e),document.addEventListener("mouseup",X),document.addEventListener("mousemove",U)},U=function(e){if(D&&w&&z.current){if(!H){var t=Math.abs(e.clientX-N),n=Math.abs(e.clientY-k);if(!(t>5||n>5))return;R(!0)}var l=z.current.getBoundingClientRect();if("progress"!==w){var c=i(o,s)/l.width,u=(e.clientX-N)*c,d=new Date(D.startDate),f=new Date(D.endDate);if("move"===w?(d=new Date(d.getTime()+24*u*60*60*1e3),f=new Date(f.getTime()+24*u*60*60*1e3)):"resize-start"===w?d=new Date(d.getTime()+24*u*60*60*1e3):"resize-end"===w&&(f=new Date(f.getTime()+24*u*60*60*1e3)),d=m(d),f=m(f),d<o&&(d=new Date(o),"move"===w)){var p=i(D.startDate,D.endDate);f=new Date(d.getTime()+24*p*60*60*1e3)}if(f>s&&(f=new Date(s),"move"===w)){p=i(D.startDate,D.endDate);d=new Date(f.getTime()-24*p*60*60*1e3)}f<d&&("resize-start"===w?d=new Date(f):f=new Date(d)),i(d,f)<1&&("resize-start"===w?(d=new Date(f)).setDate(d.getDate()-1):(f=new Date(d)).setDate(f.getDate()+1));var h=r(r({},D),{startDate:d,endDate:f});v&&v(a.id,h),x(h),M(e.clientX)}else W(e,l,D)}},W=function(e,t,n){if(z.current){var o=P(n),l=parseFloat(o.left.replace("px","")),s=parseFloat(o.width.replace("px","")),i=e.clientX-t.left-l,c=Math.max(0,Math.min(100,i/s*100));if(c=Math.round(c),n.percent!==c){var u=r(r({},n),{percent:c});h?h(a.id,n.id,c):v&&v(a.id,u),x(u)}}},X=function(e){!H&&"move"===w&&D&&p&&p(D,a),x(null),y(null),R(!1),document.removeEventListener("mouseup",X),document.removeEventListener("mousemove",U)},I=function(e){if(z.current){var t=z.current.getBoundingClientRect();O({x:e.clientX-t.left,y:e.clientY-t.top})}};e.useEffect((function(){return function(){document.removeEventListener("mouseup",X),document.removeEventListener("mousemove",U)}}),[]);var K=u(a.tasks),q=40*K.length,G=(null==f?void 0:f.tooltipBackground)||"bg-white",J=(null==f?void 0:f.tooltipText)||"text-gray-700";return n.default.createElement("div",{className:"task-row relative border-b border-gray-200",style:{height:"".concat(Math.max(60,q),"px")},onMouseMove:function(e){A&&I(e)},onMouseLeave:function(){return F(null)},ref:z},K.map((function(e,t){return e.map((function(e){var r=P(e),o=r.left,l=r.width;if(r.isOutOfRange)return null;var s=(null==A?void 0:A.id)===e.id||(null==D?void 0:D.id)===e.id;return n.default.createElement(n.default.Fragment,{key:e.id},n.default.createElement("div",{className:"absolute h-8 rounded-md ".concat(e.color||"bg-blue-500"," z-10 flex items-center px-2 text-xs text-white font-medium cursor-move shadow-sm hover:shadow transition-shadow duration-150"),style:{left:o,width:l,top:"".concat(40*t+4,"px")},onMouseDown:function(t){return j(t,e,"move")},onMouseEnter:function(){return F(e)},onClick:function(t){H||function(e,t){e.stopPropagation(),p&&p(t,a)}(t,e)}},n.default.createElement("span",{className:"truncate select-none"},e.name),void 0!==e.percent&&n.default.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 rounded-full overflow-hidden cursor-ew-resize",onMouseDown:function(t){t.stopPropagation(),j(t,e,"progress")}},n.default.createElement("div",{className:"h-full bg-white rounded-full",style:{width:"".concat(e.percent,"%")}})),s&&n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize",onMouseDown:function(t){t.stopPropagation(),j(t,e,"resize-start")}},n.default.createElement("div",{className:"absolute left-[3px] w-1 h-[16px] top-1/2 -translate-y-1/2 bg-white rounded-full"})),n.default.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize",onMouseDown:function(t){t.stopPropagation(),j(t,e,"resize-end")}},n.default.createElement("div",{className:"absolute right-[3px] w-1 h-[16px] top-1/2 -translate-y-1/2 bg-white rounded-full"})))),s&&n.default.createElement("div",{className:"absolute z-50 ".concat(G," border border-gray-200 rounded-md shadow-lg p-3 text-xs select-none"),style:{left:"".concat(Y.x+10,"px"),top:"".concat(Y.y-80,"px"),minWidth:"200px"}},n.default.createElement("div",{className:"font-bold mb-1 text-sm"},e.name),n.default.createElement("div",{className:"".concat(J," grid grid-cols-2 gap-x-3 gap-y-1")},n.default.createElement("div",{className:"font-semibold"},"Start:"),n.default.createElement("div",null,B(e.startDate)),n.default.createElement("div",{className:"font-semibold"},"End:"),n.default.createElement("div",null,B(e.endDate)),n.default.createElement("div",{className:"font-semibold"},"Duration:"),n.default.createElement("div",null,i(e.startDate,e.endDate)," days"),void 0!==e.percent&&n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"font-semibold"},"Progress:"),n.default.createElement("div",null,e.percent,"%"),n.default.createElement("div",{className:"font-semibold col-span-2 mt-1 text-xs text-gray-600"},"(Drag progress bar to adjust)")))))}))})))};exports.DEFAULT_THEME=o,exports.GanttChart=function(t){var a=t.people,l=t.startDate,s=t.endDate,c=t.title,u=void 0===c?"Project Timeline":c,m=t.showAvatar,h=void 0===m||m,g=t.showTaskCount,D=void 0===g||g,x=t.theme,E=void 0===x?o:x,w=t.onTaskUpdate,y=t.onTaskClick,b=t.onProgressChange,N=t.currentDate,M=void 0===N?new Date:N,T=t.showCurrentDateMarker,k=void 0===T||T;t.visibleColumns;var C=t.columnWidth,L=void 0===C?200:C,A=l||function(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.startDate<t&&(t=new Date(e.startDate))}))})),t}(a),F=s||function(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.endDate>t&&(t=new Date(e.endDate))}))})),t}(a),_=new Date(A);_.setDate(1);var Y=new Date(F);Y.setMonth(Y.getMonth()+1,0);var O=i(_,Y);d(_,Y);var S=e.useRef(null),H=e.useState(0),R=H[0],z=H[1],P=function(e,t,a){var n=i(t,e);return n/a*100}(M,_,O);e.useEffect((function(){var e=function(){S.current&&z(S.current.scrollLeft)},t=S.current;return t&&t.addEventListener("scroll",e),function(){t&&t.removeEventListener("scroll",e)}}),[]);var B=function(e,t){w&&w(e,t)},j=function(e,t){y&&y(e,t)},U=function(e,t,n){if(b)b(e,t,n);else if(w){var o=a.find((function(t){return t.id===e}));if(o){var l=o.tasks.find((function(e){return e.id===t}));if(l){var s=r(r({},l),{percent:n});w(e,s)}}}};return n.default.createElement("div",{className:"gantt-chart w-full rounded-lg border border-gray-200 overflow-hidden"},n.default.createElement("div",{className:"p-4 border-b border-gray-200"},n.default.createElement("h2",{className:"text-xl font-bold"},u)),n.default.createElement("div",{className:"flex"},n.default.createElement(f,{people:a,showAvatar:h,showTaskCount:D,theme:E}),n.default.createElement("div",{className:"flex-grow relative"},n.default.createElement(v,{startDate:_,endDate:Y,columnWidth:L,theme:E,scrollContainerRef:S},a.map((function(e){return n.default.createElement(p,{key:e.id,person:e,startDate:_,endDate:Y,columnWidth:L,theme:E,onTaskUpdate:B,onTaskClick:j,onProgressChange:U})}))),k&&n.default.createElement("div",{className:"absolute top-0 bottom-0 w-px ".concat(E.todayMarkerColor||"bg-red-500"," z-20"),style:{left:"".concat(P,"%"),transform:"translateX(-".concat(R,"px)")}},n.default.createElement("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 ".concat(E.todayMarkerColor||"bg-red-500"," px-2 py-1 rounded text-xs text-white whitespace-nowrap")},"Today")))))},exports.NameList=f,exports.TaskRow=p,exports.Timeline=v,exports.calculateTaskPosition=c,exports.detectCollisions=u,exports.formatDate=l,exports.generateTimelineHeader=d,exports.getDaysInMonth=s,exports.getDuration=i;
//# sourceMappingURL=index.js.map
