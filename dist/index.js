"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e),r=function(){return r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},r.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var n={headerBackground:"bg-white",headerText:"text-gray-700",backgroundHighlight:"bg-blue-50",borderColor:"border-gray-200",todayMarkerColor:"bg-red-500"};function l(e,t){for(var a=[],r=e.getFullYear(),n=e.getMonth(),l=t.getFullYear(),o=t.getMonth(),i=r;i<=l;i++)for(var s=i===l?o:11,c=i===r?n:0;c<=s;c++)a.push(new Date(i,c,1));return a}function o(e,t,a){var r=l(new Date(t.getFullYear(),t.getMonth(),1),new Date(a.getFullYear(),a.getMonth()+1,0)),n=r.length,o=e.startDate.getFullYear(),i=e.startDate.getMonth(),s=r.findIndex((function(e){return e.getFullYear()===o&&e.getMonth()===i})),c=s<0?0:s,d=e.endDate.getFullYear(),u=e.endDate.getMonth(),f=r.findIndex((function(e){return e.getFullYear()===d&&e.getMonth()===u})),m=((f<0?r.length-1:f)-c+1)/n*100;return{left:"".concat(c/n*100,"%"),width:"".concat(m,"%")}}function i(e){var t=function(e,t,a){if(a||2===arguments.length)for(var r,n=0,l=t.length;n<l;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a=[];return t.forEach((function(e){for(var t=!1,r=0;r<a.length;r++){var n=a[r][a[r].length-1];if(e.startDate>=n.endDate){a[r].push(e),t=!0;break}}t||a.push([e])})),a}function s(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.startDate<t&&(t=new Date(e.startDate))}))})),new Date(t.getFullYear(),t.getMonth(),1)}function c(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.endDate>t&&(t=new Date(e.endDate))}))})),new Date(t.getFullYear(),t.getMonth()+1,0)}function d(e,t){return new Date(e,t+1,0).getDate()}exports.DEFAULT_THEME=n,exports.GanttChart=function(t){var u=t.people,f=t.startDate,m=t.endDate,g=t.title,h=void 0===g?"Project Timeline":g,p=t.currentDate,v=void 0===p?new Date:p,x=t.showCurrentDateMarker,b=void 0===x||x,y=t.editMode,w=void 0===y||y,D=t.theme,E=void 0===D?n:D,k=t.onTaskUpdate,M=t.onTaskClick,N=e.useState(null),F=N[0],Y=N[1],S=e.useState({x:0,y:0}),T=S[0],C=S[1],L=e.useState(null),z=L[0],P=L[1],O=e.useState(null),j=O[0],X=O[1],B=e.useState(0),I=B[0],q=B[1],A=e.useRef(null),H=f||s(u),_=m||c(u),R=l(H,_),U=R.length,G=v.getMonth(),W=v.getFullYear(),J=R.findIndex((function(e){return e.getMonth()===G&&e.getFullYear()===W})),K=function(){z||Y(null)},Q=function(e,t,a,r){w&&(e.preventDefault(),e.stopPropagation(),P({task:t,person:a}),X(r),q(e.clientX),document.addEventListener("mouseup",V))},V=function(){if(z&&j&&A.current){var e=document.querySelector('[data-task-id="'.concat(z.task.id,'"]'));if(e){var t=parseFloat(e.style.left),a=parseFloat(e.style.width),n=Math.floor(t/100*U),l=Math.ceil(a/100*U);if(n>=0&&n<R.length){var o=R[n],i=n+l-1;i>=R.length&&(i=R.length-1);var s=R[i],c=new Date(o.getFullYear(),o.getMonth(),Math.min(z.task.startDate.getDate(),d(o.getFullYear(),o.getMonth()))),u=new Date(s.getFullYear(),s.getMonth(),Math.min(z.task.endDate.getDate(),d(s.getFullYear(),s.getMonth()))),f=r(r({},z.task),{startDate:c,endDate:u});k&&k(z.person.id,f)}}}P(null),X(null),document.removeEventListener("mouseup",V)};E.headerBackground,E.headerText,E.borderColor;var Z,$=E.backgroundHighlight||"bg-blue-50",ee=E.todayMarkerColor||"bg-red-500";return a.default.createElement("div",{ref:A,className:"w-full bg-white rounded-xl shadow-lg overflow-hidden","data-testid":"gantt-chart",onMouseMove:function(e){if(F&&C({x:e.clientX,y:e.clientY}),z&&j&&A.current){var t=A.current.getBoundingClientRect(),a=(e.clientX-I)/t.width*100,r=document.querySelector('[data-task-id="'.concat(z.task.id,'"]'));if(!r)return;var n=parseFloat(r.style.left),l=parseFloat(r.style.width);if(z.task.endDate.getTime(),z.task.startDate.getTime(),"move"===j){var o=Math.max(0,Math.min(100-l,n+a));r.style.left="".concat(o,"%")}else if("resize-left"===j){var i=l-5,s=Math.min(i,a),c=(o=Math.max(0,n+s),Math.max(5,l-s));r.style.left="".concat(o,"%"),r.style.width="".concat(c,"%")}else if("resize-right"===j){c=Math.max(5,Math.min(100-n,l+a));r.style.width="".concat(c,"%")}q(e.clientX)}}},a.default.createElement("div",{className:"p-6 border-b border-gray-200"},a.default.createElement("h1",{className:"text-2xl font-bold text-gray-800"},h)),a.default.createElement("div",{className:"p-4"},a.default.createElement("div",{className:"flex border-b border-gray-200"},a.default.createElement("div",{className:"w-40 flex-shrink-0 p-2 font-semibold text-gray-700 border-r border-gray-200"},"Team Member"),a.default.createElement("div",{className:"flex-grow flex"},R.map((function(e,t){return a.default.createElement("div",{key:t,className:"flex-1 p-2 font-semibold text-center ".concat(t===J?$:""),"data-month":e.toISOString()},e.toLocaleString("default",{month:"short",year:"2-digit"}))})))),a.default.createElement("div",{className:"relative"},b&&J>=0&&a.default.createElement("div",{className:"absolute top-0 w-px ".concat(ee," z-10"),style:{left:"".concat((J+.5)/R.length*100,"%"),height:"".concat((Z=0,u.forEach((function(e){var t=i(e.tasks);Z+=Math.max(60,30*t.length+15)})),Z),"px")},"data-testid":"today-marker"},a.default.createElement("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 ".concat(ee," px-1 py-0.5 rounded text-xs text-white whitespace-nowrap")},"Today")),u.map((function(e){var t=i(e.tasks),r=Math.max(60,30*t.length+15);return a.default.createElement("div",{key:e.id,className:"flex border-b border-gray-200 hover:bg-gray-50","data-testid":"person-row-".concat(e.id)},a.default.createElement("div",{className:"w-40 flex-shrink-0 p-2 border-r border-gray-200",style:{height:"".concat(r,"px")}},a.default.createElement("div",{className:"font-medium"},e.name),e.role&&a.default.createElement("div",{className:"text-xs text-gray-500"},e.role)),a.default.createElement("div",{className:"flex-grow relative",style:{height:"".concat(r,"px")}},t.map((function(t,r){return a.default.createElement(a.default.Fragment,{key:r},t.map((function(t){var n=o(t,H,_),l=n.left,i=n.width,s=(null==F?void 0:F.task.id)===t.id,c=(null==z?void 0:z.task.id)===t.id,d=(s||c)&&w;return a.default.createElement("div",{key:t.id,className:"absolute h-8 rounded ".concat(t.color," flex items-center px-2 text-xs text-white font-medium ").concat(w?"cursor-move":"cursor-pointer"),style:{left:l,width:i,top:"".concat(30*r+15,"px")},onClick:function(a){return function(e,t,a){M&&!z&&M(t,a)}(0,t,e)},onMouseDown:function(a){return Q(a,t,e,"move")},onMouseEnter:function(a){return function(e,t,a){z||(Y({task:t,person:a}),C({x:e.clientX,y:e.clientY}))}(a,t,e)},onMouseLeave:K,"data-testid":"task-".concat(t.id),"data-task-id":t.id},d&&a.default.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 cursor-ew-resize rounded-l",onMouseDown:function(a){a.stopPropagation(),Q(a,t,e,"resize-left")}}),a.default.createElement("div",{className:"truncate"},t.name),void 0!==t.percent&&a.default.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 rounded-full overflow-hidden"},a.default.createElement("div",{className:"h-full bg-white rounded-full",style:{width:"".concat(t.percent,"%")}})),d&&a.default.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-white bg-opacity-30 cursor-ew-resize rounded-r",onMouseDown:function(a){a.stopPropagation(),Q(a,t,e,"resize-right")}}))})))}))))})))),F&&!z&&a.default.createElement("div",{className:"fixed z-50 bg-white shadow-lg rounded-md border border-gray-200 p-3 text-xs",style:{left:"".concat(T.x+10,"px"),top:"".concat(T.y-80,"px"),minWidth:"200px"}},a.default.createElement("div",{className:"font-bold mb-1 text-sm"},F.task.name),a.default.createElement("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1"},a.default.createElement("div",{className:"font-semibold"},"Start:"),a.default.createElement("div",null,F.task.startDate.toLocaleDateString()),a.default.createElement("div",{className:"font-semibold"},"End:"),a.default.createElement("div",null,F.task.endDate.toLocaleDateString()),void 0!==F.task.percent&&a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"font-semibold"},"Progress:"),a.default.createElement("div",null,F.task.percent,"%")))))},exports.calculateTaskPosition=o,exports.detectTaskOverlaps=i,exports.findEarliestDate=s,exports.findLatestDate=c,exports.formatMonth=function(e){return e.toLocaleString("default",{month:"short"})},exports.getMonthsBetween=l;
//# sourceMappingURL=index.js.map
