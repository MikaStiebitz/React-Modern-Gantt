import e,{useState as t,useRef as a,useEffect as n}from"react";var r,o=function(){return o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,function(e){e.MONTH_YEAR="MONTH_YEAR",e.WEEK_DAY="WEEK_DAY",e.DAY_MONTH="DAY_MONTH",e.FULL_DATE="FULL_DATE"}(r||(r={}));var l={headerBackground:"bg-gray-50",headerText:"text-gray-700",timelineBackground:"bg-gray-50",timelineBorder:"border-gray-200",timelineText:"text-gray-500",taskDefaultColor:"bg-blue-500",highlightColor:"bg-indigo-100",todayMarkerColor:"bg-red-500",tooltipBackground:"bg-white",tooltipText:"text-gray-700"};function s(e,t){switch(void 0===t&&(t=r.MONTH_YEAR),t){case r.MONTH_YEAR:return e.toLocaleString("default",{month:"short",year:"numeric"}).toUpperCase();case r.WEEK_DAY:return e.toLocaleString("default",{weekday:"short",day:"numeric"});case r.DAY_MONTH:return e.toLocaleString("default",{day:"numeric",month:"short"});case r.FULL_DATE:return e.toLocaleDateString("default",{year:"numeric",month:"short",day:"numeric"});default:return e.toLocaleString("default",{month:"short",year:"numeric"})}}function c(e,t){return new Date(e,t+1,0).getDate()}function i(e,t){var a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)}function u(e,t,a,n){var r=new Date(t);r.setHours(0,0,0,0);var o=new Date(a);o.setHours(23,59,59,999);var l=new Date(e.startDate);l.setHours(0,0,0,0);var s=new Date(e.endDate);s.setHours(23,59,59,999);var c=i(r,o),u=Math.max(0,i(r,l)),d=Math.min(c,i(r,s)),m=Math.max(1,d-u),f=c/function(e,t){return 12*(t.getFullYear()-e.getFullYear())+t.getMonth()-e.getMonth()+1}(r,o),v=n/f,h=m*v,g=s<r||l>o;return{left:"".concat(u*v,"px"),width:"".concat(h,"px"),isOutOfRange:g}}function d(e){var t=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a=[];return t.forEach((function(e){for(var t=!1,n=0;n<a.length;n++){var r=a[n][a[n].length-1];if(e.startDate>=r.endDate){a[n].push(e),t=!0;break}}t||a.push([e])})),a}function m(e,t){for(var a=[],n=new Date(e);n<=t;)a.push(s(n,r.MONTH_YEAR)),n.setMonth(n.getMonth()+1);return a}function f(e,t){void 0===t&&(t=1);var a=new Date(e),n=a.getDate(),r=Math.round(n/t)*t;return a.setDate(r),a}var v=function(t){var a=t.people,n=t.showAvatar,r=void 0===n||n,o=t.showTaskCount,l=void 0===o||o,s=t.theme,c=(null==s?void 0:s.headerBackground)||"bg-gray-50",i=(null==s?void 0:s.headerText)||"text-gray-700",u=(null==s?void 0:s.timelineBorder)||"border-gray-200";return e.createElement("div",{className:"name-list w-64 flex-shrink-0 bg-white border-r border-gray-200 z-10"},e.createElement("div",{className:"h-24 border-b ".concat(u," ").concat(c," flex items-center justify-center")},e.createElement("span",{className:"font-semibold ".concat(i)},"Team Members")),e.createElement("div",{className:"people-list"},a.map((function(t,n){var o=d(t.tasks),s=Math.max(60,40*o.length),c=t.name.charAt(0).toUpperCase();return e.createElement("div",{key:t.id,className:"flex items-center px-4 ".concat(n!==a.length-1?"border-b ".concat(u):""),style:{height:"".concat(s,"px")}},r&&(t.avatar?e.createElement("img",{src:t.avatar,alt:t.name,className:"w-8 h-8 rounded-full mr-3"}):e.createElement("div",{className:"w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-white text-sm mr-3"},c)),e.createElement("div",{className:"flex flex-col"},e.createElement("div",{className:"font-medium text-sm"},t.name),t.role&&e.createElement("div",{className:"text-xs text-gray-500"},t.role),l&&e.createElement("div",{className:"text-xs text-gray-500 mt-1"},t.tasks.length," ",1===t.tasks.length?"task":"tasks")))}))))},h=function(t){for(var a=t.startDate,n=t.endDate,o=t.columnWidth,l=t.theme,i=t.children,u=t.scrollContainerRef,d=[],m=new Date(a);m<=n;)d.push({date:new Date(m),daysInMonth:c(m.getFullYear(),m.getMonth())}),m.setMonth(m.getMonth()+1);var f=(null==l?void 0:l.headerBackground)||"bg-gray-50",v=(null==l?void 0:l.headerText)||"text-gray-700",h=(null==l?void 0:l.timelineBorder)||"border-gray-200",g=(null==l?void 0:l.timelineText)||"text-gray-500";return e.createElement("div",{className:"timeline flex-grow overflow-x-auto overflow-y-hidden",ref:u},e.createElement("div",{className:"inline-block min-w-full"},e.createElement("div",{className:"grid border-b",style:{gridTemplateColumns:"repeat(".concat(d.length,", ").concat(o,"px)")}},d.map((function(t,a){return e.createElement("div",{key:"month-".concat(a),className:"border-r ".concat(h)},e.createElement("div",{className:"flex h-12 items-center justify-center ".concat(f)},e.createElement("p",{className:"font-semibold ".concat(v)},s(t.date,r.MONTH_YEAR))),e.createElement("div",{className:"flex h-12 items-center justify-between px-2 text-xs ".concat(g," ").concat(f)},[1,8,15,22,29].map((function(a){var n=a<=t.daysInMonth?a:t.daysInMonth;return e.createElement("div",{key:"day-".concat(t.date.getMonth(),"-").concat(a),className:"relative",style:{width:"20px",textAlign:"center"}},e.createElement("span",null,n),e.createElement("div",{className:"absolute top-full h-screen w-px bg-gray-200 -z-10",style:{left:"50%",transform:"translateX(-50%)"}}))}))))}))),e.createElement("div",{className:"relative task-container"},i)))},g=function(l){var c=l.person,m=l.startDate,v=l.endDate,h=l.columnWidth,g=l.theme,p=l.onTaskUpdate,D=l.onTaskClick,E=l.onProgressChange,w=t(null),x=w[0],b=w[1],y=t(null),N=y[0],M=y[1],k=t(0),T=k[0],C=k[1],A=t(0),L=A[0],Y=A[1],O=t(null),_=O[0],z=O[1],H=t({x:0,y:0}),F=H[0],R=H[1],B=t(!1),P=B[0],U=B[1],W=a(null),j=function(e){return u(e,m,v,h)},S=function(e){return s(e,r.FULL_DATE)},X=function(e,t,a){e.preventDefault(),b(t),M(a),C(e.clientX),Y(e.clientY),U(!1),G(e),document.addEventListener("mouseup",q),document.addEventListener("mousemove",I)},I=function(e){if(x&&N&&W.current){if(!P){var t=Math.abs(e.clientX-T),a=Math.abs(e.clientY-L);if(!(t>5||a>5))return;U(!0)}var n=W.current.getBoundingClientRect();if("progress"!==N){var r=i(m,v)/n.width,l=(e.clientX-T)*r,s=new Date(x.startDate),u=new Date(x.endDate);if("move"===N?(s=new Date(s.getTime()+24*l*60*60*1e3),u=new Date(u.getTime()+24*l*60*60*1e3)):"resize-start"===N?s=new Date(s.getTime()+24*l*60*60*1e3):"resize-end"===N&&(u=new Date(u.getTime()+24*l*60*60*1e3)),s=f(s),u=f(u),s<m&&(s=new Date(m),"move"===N)){var d=i(x.startDate,x.endDate);u=new Date(s.getTime()+24*d*60*60*1e3)}if(u>v&&(u=new Date(v),"move"===N)){d=i(x.startDate,x.endDate);s=new Date(u.getTime()-24*d*60*60*1e3)}u<s&&("resize-start"===N?s=new Date(u):u=new Date(s)),i(s,u)<1&&("resize-start"===N?(s=new Date(u)).setDate(s.getDate()-1):(u=new Date(s)).setDate(u.getDate()+1));var h=o(o({},x),{startDate:s,endDate:u});p&&p(c.id,h),b(h),C(e.clientX)}else K(e,n,x)}},K=function(e,t,a){if(W.current){var n=j(a),r=parseFloat(n.left.replace("px","")),l=parseFloat(n.width.replace("px","")),s=e.clientX-t.left-r,i=Math.max(0,Math.min(100,s/l*100));if(i=Math.round(i),a.percent!==i){var u=o(o({},a),{percent:i});E?E(c.id,a.id,i):p&&p(c.id,u),b(u)}}},q=function(e){!P&&"move"===N&&x&&D&&D(x,c),b(null),M(null),U(!1),document.removeEventListener("mouseup",q),document.removeEventListener("mousemove",I)},G=function(e){if(W.current){var t=W.current.getBoundingClientRect();R({x:e.clientX-t.left,y:e.clientY-t.top})}};n((function(){return function(){document.removeEventListener("mouseup",q),document.removeEventListener("mousemove",I)}}),[]);var J=d(c.tasks),Q=40*J.length,V=(null==g?void 0:g.tooltipBackground)||"bg-white",Z=(null==g?void 0:g.tooltipText)||"text-gray-700";return e.createElement("div",{className:"task-row relative border-b border-gray-200",style:{height:"".concat(Math.max(60,Q),"px")},onMouseMove:function(e){_&&G(e)},onMouseLeave:function(){return z(null)},ref:W},J.map((function(t,a){return t.map((function(t){var n=j(t),r=n.left,o=n.width;if(n.isOutOfRange)return null;var l=(null==_?void 0:_.id)===t.id||(null==x?void 0:x.id)===t.id;return e.createElement(e.Fragment,{key:t.id},e.createElement("div",{className:"absolute h-8 rounded-md ".concat(t.color||"bg-blue-500"," z-10 flex items-center px-2 text-xs text-white font-medium cursor-move shadow-sm hover:shadow transition-shadow duration-150"),style:{left:r,width:o,top:"".concat(40*a+4,"px")},onMouseDown:function(e){return X(e,t,"move")},onMouseEnter:function(){return z(t)},onClick:function(e){P||function(e,t){e.stopPropagation(),D&&D(t,c)}(e,t)}},e.createElement("span",{className:"truncate select-none"},t.name),void 0!==t.percent&&e.createElement("div",{className:"absolute bottom-1 left-1 right-1 h-1 bg-black bg-opacity-20 rounded-full overflow-hidden cursor-ew-resize",onMouseDown:function(e){e.stopPropagation(),X(e,t,"progress")}},e.createElement("div",{className:"h-full bg-white rounded-full",style:{width:"".concat(t.percent,"%")}})),l&&e.createElement(e.Fragment,null,e.createElement("div",{className:"absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize",onMouseDown:function(e){e.stopPropagation(),X(e,t,"resize-start")}},e.createElement("div",{className:"absolute left-[3px] w-1 h-[16px] top-1/2 -translate-y-1/2 bg-white rounded-full"})),e.createElement("div",{className:"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize",onMouseDown:function(e){e.stopPropagation(),X(e,t,"resize-end")}},e.createElement("div",{className:"absolute right-[3px] w-1 h-[16px] top-1/2 -translate-y-1/2 bg-white rounded-full"})))),l&&e.createElement("div",{className:"absolute z-50 ".concat(V," border border-gray-200 rounded-md shadow-lg p-3 text-xs select-none"),style:{left:"".concat(F.x+10,"px"),top:"".concat(F.y-80,"px"),minWidth:"200px"}},e.createElement("div",{className:"font-bold mb-1 text-sm"},t.name),e.createElement("div",{className:"".concat(Z," grid grid-cols-2 gap-x-3 gap-y-1")},e.createElement("div",{className:"font-semibold"},"Start:"),e.createElement("div",null,S(t.startDate)),e.createElement("div",{className:"font-semibold"},"End:"),e.createElement("div",null,S(t.endDate)),e.createElement("div",{className:"font-semibold"},"Duration:"),e.createElement("div",null,i(t.startDate,t.endDate)," days"),void 0!==t.percent&&e.createElement(e.Fragment,null,e.createElement("div",{className:"font-semibold"},"Progress:"),e.createElement("div",null,t.percent,"%"),e.createElement("div",{className:"font-semibold col-span-2 mt-1 text-xs text-gray-600"},"(Drag progress bar to adjust)")))))}))})))},p=function(r){var s=r.people,c=r.startDate,u=r.endDate,d=r.title,f=void 0===d?"Project Timeline":d,p=r.showAvatar,D=void 0===p||p,E=r.showTaskCount,w=void 0===E||E,x=r.theme,b=void 0===x?l:x,y=r.onTaskUpdate,N=r.onTaskClick,M=r.onProgressChange,k=r.currentDate,T=void 0===k?new Date:k,C=r.showCurrentDateMarker,A=void 0===C||C;r.visibleColumns;var L=r.columnWidth,Y=void 0===L?200:L,O=c||function(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.startDate<t&&(t=new Date(e.startDate))}))})),t}(s),_=u||function(e){var t=new Date;return e.forEach((function(e){e.tasks.forEach((function(e){e.endDate>t&&(t=new Date(e.endDate))}))})),t}(s),z=new Date(O);z.setDate(1);var H=new Date(_);H.setMonth(H.getMonth()+1,0);var F=i(z,H);m(z,H);var R=a(null),B=t(0),P=B[0],U=B[1],W=function(e,t,a){var n=i(t,e);return n/a*100}(T,z,F);n((function(){var e=function(){R.current&&U(R.current.scrollLeft)},t=R.current;return t&&t.addEventListener("scroll",e),function(){t&&t.removeEventListener("scroll",e)}}),[]);var j=function(e,t){y&&y(e,t)},S=function(e,t){N&&N(e,t)},X=function(e,t,a){if(M)M(e,t,a);else if(y){var n=s.find((function(t){return t.id===e}));if(n){var r=n.tasks.find((function(e){return e.id===t}));if(r){var l=o(o({},r),{percent:a});y(e,l)}}}};return e.createElement("div",{className:"gantt-chart w-full rounded-lg border border-gray-200 overflow-hidden"},e.createElement("div",{className:"p-4 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-bold"},f)),e.createElement("div",{className:"flex"},e.createElement(v,{people:s,showAvatar:D,showTaskCount:w,theme:b}),e.createElement("div",{className:"flex-grow relative"},e.createElement(h,{startDate:z,endDate:H,columnWidth:Y,theme:b,scrollContainerRef:R},s.map((function(t){return e.createElement(g,{key:t.id,person:t,startDate:z,endDate:H,columnWidth:Y,theme:b,onTaskUpdate:j,onTaskClick:S,onProgressChange:X})}))),A&&e.createElement("div",{className:"absolute top-0 bottom-0 w-px ".concat(b.todayMarkerColor||"bg-red-500"," z-20"),style:{left:"".concat(W,"%"),transform:"translateX(-".concat(P,"px)")}},e.createElement("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 ".concat(b.todayMarkerColor||"bg-red-500"," px-2 py-1 rounded text-xs text-white whitespace-nowrap")},"Today")))))};export{l as DEFAULT_THEME,r as DateDisplayFormat,p as GanttChart,v as NameList,g as TaskRow,h as Timeline,u as calculateTaskPosition,d as detectCollisions,s as formatDate,m as generateTimelineHeader,c as getDaysInMonth,i as getDuration};
//# sourceMappingURL=index.esm.js.map
